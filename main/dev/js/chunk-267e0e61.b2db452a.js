(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-267e0e61"],{"0786":function(e,t,s){"use strict";s("b1ac")},"2f94":function(e,t,s){"use strict";t["a"]={addAddress:"/address/add",deleteAddress:"/address/delete",editAddress:"/address/edit",addressList:"/address/list"}},"4e5e":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"hobby"},[t("main-header"),t("div",{ref:"layout-body",staticClass:"layout-body"},[e.hobby?t("div",{staticClass:"layout-wrapper"},[t("div",{staticClass:"hobby-info"},[t("div",{staticClass:"left"},[t("el-carousel",{attrs:{width:"300",height:"200px"}},e._l(e.displayPictures,(function(s){return t("el-carousel-item",{key:s},[t("el-image",{staticClass:"img",attrs:{width:"300",height:"200",alt:e.hobby.name,src:s,fit:"contain","preview-src-list":e.displayPictures}})],1)})),1)],1),t("div",{staticClass:"right"},[t("h3",[e._v(e._s(e.hobby.name))]),t("div",{staticClass:"hobby-limitation"},[t("div",{staticClass:"hobby-limitation--item"},[e._v(" 积分 "),t("span",{staticClass:"hobby-limitation--item__value",class:e.siteClass},[e._v(e._s(e.hobby.point))])])]),t("div",{staticClass:"hobby-limitation"},[t("div",{staticClass:"hobby-limitation--item"},[e._v(" 库存 "),t("span",{class:e.restClass},[e._v(e._s(e.restText))])])]),e.hobby.expire||e.hobby.max?t("div",{staticClass:"hobby-limitation"},[e.hobby.expire?t("div",{staticClass:"hobby-limitation--item"},[e._v(" 兑换期限 "),t("span",[e._v(e._s(e.hobby.expire))]),e._v(" 前 ")]):e._e(),e.hobby.max?t("div",{staticClass:"hobby-limitation--item"},[e._v(" 最多可兑换 "),t("span",[e._v(e._s(e.hobby.max))]),e._v(" 件 ")]):e._e()]):e._e(),t("div",{staticClass:"exchange"},[t("h-button",{attrs:{disabled:!e.canExchange},on:{click:e.editExchangeInfo}},[e._v("申请兑换")])],1)])]),t("div",{staticClass:"menu-bar"},[t("div",{staticClass:"menu-bar--item",class:{selected:0===e.type},on:{click:function(t){return e.setType(0)}}},[e._v("周边详情")]),t("div",{staticClass:"menu-bar--item",class:{selected:1===e.type},on:{click:function(t){return e.setType(1)}}},[e._v(" 评论("+e._s(e.hobby.comments)+") ")])]),t("div",{staticClass:"content"},[0===e.type?t("div",{staticClass:"description"},[e._v(" "+e._s(e.hobby.description)+" ")]):e._e(),1===e.type?t("div",{staticClass:"comments"},[t("hobby-comments",{attrs:{hobbyId:e.hobby.id},on:{"change-total":e.changeTotal,comment:e.commitComment}})],1):e._e()])]):e._e()]),t("el-dialog",{attrs:{title:"周边兑换",visible:e.showExchange,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showExchange=t},closed:e.resetExchangeInfo}},[t("div",{staticClass:"quick-address"},[t("el-select",{attrs:{placeholder:"选择已保存的地址"},on:{change:e.userAddress},model:{value:e.addressId,callback:function(t){e.addressId=t},expression:"addressId"}},e._l(e.addressList,(function(e){return t("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})})),1)],1),t("div",{staticClass:"hobby-item-short"},[t("div",{staticClass:"hobby-label-short"},[e._v("收件人")]),t("h-input",{staticClass:"hobby-record input",attrs:{maxlength:20},model:{value:e.exchangeInfo.receiver,callback:function(t){e.$set(e.exchangeInfo,"receiver",t)},expression:"exchangeInfo.receiver"}})],1),t("div",{staticClass:"hobby-item-short"},[t("div",{staticClass:"hobby-label-short"},[e._v("电话号码")]),t("h-input",{staticClass:"hobby-record input",model:{value:e.exchangeInfo.tel,callback:function(t){e.$set(e.exchangeInfo,"tel",t)},expression:"exchangeInfo.tel"}})],1),t("div",{staticClass:"hobby-item-short"},[t("div",{staticClass:"hobby-label-short"},[e._v("收件地址")]),t("h-input",{staticClass:"hobby-record input",attrs:{maxlength:200},model:{value:e.exchangeInfo.addr,callback:function(t){e.$set(e.exchangeInfo,"addr",t)},expression:"exchangeInfo.addr"}})],1),e.hobby&&e.hobby.virtual?t("div",{staticClass:"hobby-item-short"},[t("div",{staticClass:"hobby-label-short"},[e._v("淘宝账号")]),t("h-input",{staticClass:"hobby-record input",attrs:{placeholder:"淘宝账号（账号名）是您后续购买专辑的唯一凭证，专辑发货前请勿修改账号名！"},model:{value:e.exchangeInfo.tb_account,callback:function(t){e.$set(e.exchangeInfo,"tb_account",t)},expression:"exchangeInfo.tb_account"}})],1):e._e(),t("div",{staticClass:"hobby-item-short"},[t("div",{staticClass:"hobby-label-short"},[e._v("兑换数量")]),t("div",{staticClass:"input"},[t("el-input-number",{attrs:{min:1,max:e.max,step:1,"step-strictly":!0},model:{value:e.exchangeInfo.count,callback:function(t){e.$set(e.exchangeInfo,"count",t)},expression:"exchangeInfo.count"}})],1)]),t("div",{staticClass:"hobby-item-short"},[t("div",{staticClass:"hobby-label-short"},[e._v("留言")]),t("h-input",{staticClass:"hobby-record input",attrs:{maxlength:500},model:{value:e.exchangeInfo.note,callback:function(t){e.$set(e.exchangeInfo,"note",t)},expression:"exchangeInfo.note"}})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("h-button",{staticStyle:{"margin-right":"20px"},attrs:{size:"small",plain:""},on:{click:function(t){e.showExchange=!1}}},[e._v("取 消")]),t("h-button",{attrs:{size:"small",type:"primary"},on:{click:e.commitExchange}},[e._v("确 定")])],1)])],1)},i=[],o=(s("0643"),s("fffc"),s("ed89")),n=s("4360"),c=s("db04"),r=s("5ee2"),h=s("2f94"),l=s("dbbe"),b=s("6275"),d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"hobby-comments"},[e._l(e.commentList,(function(s){return t("hobby-reply",{key:s.id,attrs:{reply:s},on:{"comment-delete":e.refresh}})})),e.isMobile?t("load-more",{key:"comment-list",attrs:{name:"comment-list","have-more":!e.loadDone},on:{"load-more":e.getCommentList}}):t("el-pagination",{attrs:{"prev-text":"上一页","next-text":"下一页","current-page":e.page,"page-size":e.pageSize,layout:"prev, pager, next, jumper, total",total:e.total},on:{"current-change":e.getComments}}),t("editor",{ref:"editor",staticClass:"post-editor",on:{post:e.handlePost}})],2)},m=[],u=(s("14d9"),s("b0b1")),p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"hobby-reply"},[t("div",{staticClass:"user-info"},[t("brief-author",{attrs:{nickname:e.user.nickname,colors:e.levelInfo.color,iconSize:16,uid:e.user.uid,avatar:e.user.avatar,size:40,auth:e.user.auth,authentication:e.user.authentication}}),t("level-label",{attrs:{level:e.levelInfo}})],1),t("div",{staticClass:"content",domProps:{innerHTML:e._s(e.reply.content)}}),t("div",{staticClass:"time-and-operations"},[t("div",{staticClass:"time"},[e._v(e._s(e.time))]),e.isAdmin||e.isSelf?t("hobby-reply-expand",{staticClass:"expand",attrs:{isAdmin:e.isAdmin,isSelf:e.isSelf},on:{ban:e.ban,delete:e.deleteReply}}):e._e()],1)])},y=[],g=s("2f62"),f=s("ed08"),v=s.n(f),x=s("9fbf"),C=s("99ca"),_=function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{width:80,"popper-class":"post-action-popover",placement:"bottom",trigger:"click"}},[t("ul",{staticClass:"post-action-list"},[e._l(e.expandList,(function(s){return[s.show?t("li",{key:s.eventName,staticClass:"post-action-list-item",on:{click:function(t){return e.handleEvent(s.eventName)}}},[e._v(" "+e._s(s.text)+" ")]):e._e()]}))],2),t("div",{staticClass:"post-action__origin",attrs:{slot:"reference"},slot:"reference"},[t("i",{staticClass:"hanser icon-gengduo"})])])},I=[],w={name:"post-action",props:["isAdmin","isSelf"],computed:{expandList(){return[{text:"封禁",eventName:"ban",show:this.isAdmin},{text:"删除回复",eventName:"delete",show:this.isAdmin||this.isSelf}]}},methods:{handleEvent(e){this.$emit(e)}}},k=w,$=(s("0786"),s("2877")),L=Object($["a"])(k,_,I,!1,null,null,null),E=L.exports,z=s("e100"),S={name:"hobby-reply",props:["reply"],components:{BriefAuthor:x["a"],LevelLabel:C["a"],HobbyReplyExpand:E},computed:{...Object(g["d"])({levels:e=>e.level.levels,loginUser:e=>e.users.userInfo,isMobile:e=>e.media.isMobile}),...Object(g["b"])("users",{isAdmin:"isAdmin"}),isSelf(){return this.user.uid===this.loginUser.uid},levelInfo(){return v.a.getLevelInfo(this.user.exp,this.levels)},user(){return this.reply.user},userLink(){return"/space/"+this.user.uid},time(){return Object(z["a"])(this.reply.time)}},methods:{ban(){this.$showBanDialog(this.user,0,this.isMobile,()=>{})},deleteReply(){this.$confirm("确认删除","删除评论",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c["a"].post(r["a"].hobbyCommentDelete+this.reply.id).then(e=>{0===e.code?(this.$message({type:"success",message:e.msg}),this.$emit("comment-delete")):this.$message({type:"warning",message:e.msg})})}).catch(()=>{this.$message({type:"success",message:"已取消删除~"})})}}},A=S,H=(s("d279"),Object($["a"])(A,p,y,!1,null,"60c3ada8",null)),T=H.exports,U=s("4445"),j={name:"hobby-comments",data(){return{commentList:[],page:1,pageSize:20,total:0,loadDone:!1,loading:!1}},props:["hobbyId"],components:{Editor:u["a"],HobbyReply:T,LoadMore:U["a"]},computed:{...Object(g["d"])({isMobile:e=>e.media.isMobile})},methods:{handlePost(e){this.$emit("comment",e)},getComments(e){this.page=e,this.getCommentList()},getCommentList(){this.loading||(this.loading=!0,c["a"].get(r["a"].hobbyComments,{params:{page:this.page,pageSize:this.pageSize,id:this.hobbyId}}).then(e=>{0===e.code?(this.total=e.total,this.$emit("change-total",this.total),this.isMobile?(this.commentList.push(...e.list),this.page++):this.commentList=e.list,e.list.length<this.pageSize&&(this.loadDone=!0)):this.$message({type:"warning",message:e.msg}),this.loading=!1}))},refresh(){this.commentList=[],this.page=1,this.pageSize=20,this.total=0,this.loadDone=!1,this.loading=!1,this.getCommentList()}},mounted(){this.getCommentList()}},D=j,M=Object($["a"])(D,d,m,!1,null,"3cb25815",null),O=M.exports,B={name:"hobby",data(){return{hobby:null,type:0,canExchange:!1,addressId:"",id:1,addressList:[],exchangeInfo:{count:1,receiver:"",tel:"",addr:"",tb_account:"",note:""},showExchange:!1,friends:[],defaultCover:"https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg"}},components:{MainHeader:o["a"],HButton:l["a"],HInput:b["a"],HobbyComments:O},computed:{hobbyId(){return Number(this.$route.params.hobbyId)},displayPictures(){return this.hobby.pictures.length?this.hobby.pictures:[this.defaultCover]},siteClass(){switch(this.hobby.platform){case 1:return"hobby-douyu";case 2:return"hobby-bilibili";case 3:return"hobby-both"}return""},platform(){switch(this.hobby.platform){case 1:return"斗鱼";case 2:return"B站";case 3:return"全部平台"}return""},restText(){return 0===this.hobby.count?"库存不限":String(this.hobby.rest)},restClass(){return 0===this.hobby.count||this.hobby.rest>10?"hobby-status--normal":this.hobby.rest>0?"hobby-status--warning":"hobby-status--danger"},max(){var e;return(null===(e=this.hobby)||void 0===e?void 0:e.max)||99999}},methods:{getHobbyInfo(){c["a"].get(r["a"].hobby+this.hobbyId).then(e=>{0!==e.code?(this.$message({type:"warning",message:e.msg}),this.$router.replace("/404")):(this.hobby=e.info,e.info.id||this.$router.replace("/404"))})},resetExchangeInfo(){this.addressId="",this.exchangeInfo={count:0,receiver:"",tel:"",addr:"",tb_account:"",note:""}},getColorClass(e){return e?"hobby-status--normal":"hobby-status--warning"},setType(e){this.type=e},commitComment(e){c["a"].post(r["a"].hobbyComment+this.hobby.id,{content:e}).then(e=>{0===e.code?(this.$message({type:"success",message:e.msg}),window.location.reload()):this.$message({type:"warning",message:e.msg})})},changeTotal(e){this.hobby.comments=e},getCanExchange(){c["a"].get(r["a"].hobbyCanExchange,{params:{id:this.hobbyId}}).then(e=>{0===e.code?this.canExchange=!!e.canExchange:this.canExchange=!1})},editExchangeInfo(){this.showExchange=!0},getAddressList(){c["a"].get(h["a"].addressList).then(e=>{0===e.code?this.addressList=e.list:this.$message({type:"warning",message:e.msg})})},userAddress(){const e=this.addressList.find(e=>e.id===this.addressId);e&&(this.exchangeInfo.receiver=e.receiver,this.exchangeInfo.tel=e.tel,this.exchangeInfo.addr=e.addr,this.exchangeInfo.tb_account=e.tb_account)},commitExchange(){this.$confirm(`你将使用 ${this.hobby.point*this.exchangeInfo.count} 积分兑换 ${this.exchangeInfo.count} 份 ${this.hobby.name} 周边，请确认所有信息后按确认提交兑换`,"兑换周边",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c["a"].post(r["a"].exchangeHobby,{id:this.hobbyId,...this.exchangeInfo}).then(e=>{0===e.code?(this.$message({type:"success",message:e.msg}),this.showExchange=!1,n["a"].dispatch("score/updateScore"),this.getHobbyInfo(),this.getCanExchange(),this.resetExchangeInfo()):this.$message({type:"warning",message:e.msg})})}).catch(()=>{this.$message({type:"success",message:"已取消兑换~"})})}},mounted(){this.getHobbyInfo(),this.getCanExchange(),this.getAddressList()}},N=B,P=(s("cd9e"),Object($["a"])(N,a,i,!1,null,"29bd8258",null));t["default"]=P.exports},"5d75":function(e,t,s){},"5ee2":function(e,t,s){"use strict";t["a"]={hobbyCreate:"/hobby/create",hobbyList:"/hobby/list",hobbyDelete:"/hobby/delete",hobbyOn:"/hobby/set-on",hobbyDown:"/hobby/set-down",hobbyEdit:"/hobby/edit",userHobbyList:"/hobby/score/list",hobby:"/hobby/",hobbyComment:"/hobby/comment/",hobbyComments:"/hobby/comments",hobbyCommentDelete:"/hobby/comment/delete/",hobbyCanExchange:"/hobby/can-exchange",exchangeHobby:"/hobby/exchange",borrowExchange:"/hobby/borrow-exchange"}},"7a0b":function(e,t,s){},"9fbf":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"brief-author"},["post-details"===e.type?t("detail-avatar",{attrs:{avatar:e.avatar,level:e.level,uid:e.uid,nickname:e.nickname,focusHe:e.focusHe,exp:e.exp,auth:e.auth,iconSize:e.iconSize,authentication:e.authentication},on:{getUserInfo:e.getUserInfo,followUser:e.followUser}},[t("template",{slot:"avatar-slot"},[t("link-avatar",{attrs:{avatar:e.avatar,size:e.size,auth:e.auth,uid:e.uid,iconSize:e.iconSize,authentication:e.authentication,nickname:e.nickname}})],1)],2):t("link-avatar",{attrs:{avatar:e.avatarUrl,size:e.size,auth:e.auth,uid:e.uid,iconSize:e.iconSize,authentication:e.authentication,nickname:e.nickname}}),t("level-nickname",{staticClass:"level-nickname-wrapper",attrs:{colors:e.colors,uid:e.uid,nickname:e.nickname}}),e._t("default")],2)},i=[],o=s("c362"),n=s("e51f"),c=s("919f"),r={name:"brief-author",props:["type","nickname","colors","iconSize","uid","avatar","size","auth","authentication","level","exp","focusHe"],components:{LinkAvatar:o["a"],LevelNickname:n["a"],DetailAvatar:c["a"]},computed:{avatarUrl(){return this.avatar||"https://cdn.2550505.com/share/legacy-sso/thumbnail.default.png"}},methods:{getUserInfo(){this.$emit("getUserInfo",this.uid)},followUser(e,t){this.$emit("followUser",e,t)}}},h=r,l=(s("f12e"),s("2877")),b=Object(l["a"])(h,a,i,!1,null,"5ff0f064",null);t["a"]=b.exports},a094:function(e,t,s){},b1ac:function(e,t,s){},cd9e:function(e,t,s){"use strict";s("7a0b")},d279:function(e,t,s){"use strict";s("5d75")},f12e:function(e,t,s){"use strict";s("a094")}}]);