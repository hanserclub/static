(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c778b60"],{"0a3a":function(s,t,e){},"0ff8":function(s,t,e){},"2f94":function(s,t,e){"use strict";t["a"]={addAddress:"/address/add",deleteAddress:"/address/delete",editAddress:"/address/edit",addressList:"/address/list"}},"5ee2":function(s,t,e){"use strict";t["a"]={hobbyCreate:"/hobby/create",hobbyList:"/hobby/list",hobbyDelete:"/hobby/delete",hobbyOn:"/hobby/set-on",hobbyDown:"/hobby/set-down",hobbyEdit:"/hobby/edit",userHobbyList:"/hobby/score/list",hobby:"/hobby/",hobbyComment:"/hobby/comment/",hobbyComments:"/hobby/comments",hobbyCommentDelete:"/hobby/comment/delete/",hobbyCanExchange:"/hobby/can-exchange",exchangeHobby:"/hobby/exchange",borrowExchange:"/hobby/borrow-exchange"}},"6aa5":function(s,t,e){"use strict";e("70a6")},"70a6":function(s,t,e){},"72e2":function(s,t,e){},"7acb":function(s,t,e){"use strict";e("72e2")},"8a97":function(s,t,e){"use strict";e("a1e4")},"8e96":function(s,t,e){},"9aa4":function(s,t,e){"use strict";e("e1bf")},a1e4:function(s,t,e){},aff5:function(s,t,e){"use strict";e("0ff8")},d268:function(s,t,e){"use strict";e("8e96")},e1bf:function(s,t,e){},ec50:function(s,t,e){"use strict";e.r(t);var a=function(){var s=this,t=s._self._c;return t("div",{staticClass:"score"},[t("div",{staticClass:"score-wrapper"},[t("nav",{staticClass:"score-nav"},[s._l(s.navList,(function(e){return[t("router-link",{key:e.hash,class:{"nav-item":!0,selected:s.checkSelected(e.hash)},attrs:{to:s.$route.path+e.hash,replace:""}},[s._v(" "+s._s(e.text)+" ")])]}))],2),t(s.navItem,{tag:"component",staticClass:"content-wrapper"})],1)])},r=[],i=(e("0643"),e("fffc"),e("2f62")),o=function(){var s=this,t=s._self._c;return t("div",{staticClass:"exchange"},[t("div",{staticClass:"hobby-wrapper"},[s.hobbyList.length?s._e():t("div",{staticClass:"no-data"},[s._v("暂无数据")]),s._l(s.hobbyList,(function(s){return t("exchange-display",{key:s.id,attrs:{hobby:s}})}))],2),s.isMobile?t("load-more",{key:"exchange-list",attrs:{name:"exchange-list","have-more":!s.loadDone},on:{"load-more":s.getMoreHobbyList}}):t("el-pagination",{attrs:{"prev-text":"上一页","next-text":"下一页","current-page":s.page,"page-size":s.pageSize,layout:"prev, pager, next, jumper, total",total:s.total},on:{"current-change":s.getHobbyList,"update:currentPage":function(t){s.page=t},"update:current-page":function(t){s.page=t}}})],1)},d=[],c=(e("14d9"),e("5ee2")),n=e("db04"),l=function(){var s=this,t=s._self._c;return t("a",{staticClass:"exchange-display",attrs:{href:s.hobbyLink,target:"_blank"}},[t("el-image",{staticClass:"image",attrs:{fit:"contain",alt:s.hobby.name,src:s.hobby.pictures.length?s.hobby.pictures[0]:s.defaultCover}},[t("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[t("img",{attrs:{width:"100%",height:"200",alt:"loading",src:"https://cdn.2550505.com/share/legacy-sso/loading.jpg"}})])]),t("div",{staticClass:"hobby-info"},[t("div",{staticClass:"hobby-name"},[s._v(s._s(s.hobby.name))]),t("div",{staticClass:"hobby-data"},[t("div",{staticClass:"hobby-score"},[s._v(" 积分"),t("span",{staticClass:"hobby-value",class:s.siteClass},[s._v(s._s(s.hobby.point))])]),t("div",{staticClass:"hobby-comments"},[s._v(" 评论"),t("span",{staticClass:"hobby-value"},[s._v(s._s(s.hobby.comments))])])])])],1)},h=[],u={name:"exchange-display",props:["hobby"],data(){return{defaultCover:"https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg"}},computed:{siteClass(){switch(this.hobby.platform){case 1:return"hobby-douyu";case 2:return"hobby-bilibili";case 3:return"hobby-both"}return""},hobbyLink(){return"/score-hobby/"+this.hobby.id}}},b=u,p=(e("d268"),e("2877")),m=Object(p["a"])(b,l,h,!1,null,"5f9af7b8",null),g=m.exports,v=e("4445"),y={name:"exchange",data(){return{page:1,pageSize:15,hobbyList:[],total:0,loadDone:!1,loading:!1}},components:{ExchangeDisplay:g,LoadMore:v["a"]},computed:{...Object(i["d"])({isMobile:s=>s.media.isMobile})},methods:{getMoreHobbyList(){this.getHobbyList(),this.page++},getHobbyList(){this.loading||(this.loading=!0,n["a"].get(c["a"].userHobbyList,{params:{page:this.page,pageSize:this.pageSize}}).then(s=>{0===s.code?(this.total=s.total,this.isMobile?this.hobbyList.push(...s.list):this.hobbyList=s.list,0===s.list.length&&(this.loadDone=!0)):this.$message({type:"warning",message:s.msg}),this.loading=!1}))}},mounted(){this.isMobile||this.getHobbyList()}},f=y,_=(e("7acb"),Object(p["a"])(f,o,d,!1,null,"7d69c8a8",null)),C=_.exports,w=function(){var s=this,t=s._self._c;return t("div",{staticClass:"point"},[s._v("开发中~")])},A=[],x={name:"point"},L=x,k=Object(p["a"])(L,w,A,!1,null,"647711fa",null),$=k.exports,O=function(){var s=this,t=s._self._c;return t("div",{staticClass:"manage"},[t("div",{staticClass:"header"},[t("div",{staticClass:"order-nav--wrapper"},s._l(s.orderNav,(function(e){return t("router-link",{key:e.status,class:{"nav-item":!0,selected:s.isSelected(e.status)},attrs:{replace:"",to:`${s.$route.path}?status=${e.status}${s.$route.hash}`}},[s._v(" "+s._s(e.text)+" "),e.count?t("span",[s._v("("+s._s(e.count)+")")]):s._e()])})),1)]),t("div",{staticClass:"orders"},[10===s.status?[s.borrowTotal?s._e():t("div",{staticClass:"no-data"},[s._v("暂无数据")]),s._l(s.orderList,(function(e){return t("borrow-order",{key:e.id,attrs:{order:e},on:{agree:s.agree,refuse:s.refuse}})}))]:[s.currentTotal?s._e():t("div",{staticClass:"no-data"},[s._v("暂无数据")]),s._l(s.orderList,(function(s){return t("user-order",{key:s.id,attrs:{order:s}})}))]],2),10!==s.status?[s.isMobile?t("load-more",{key:"user-order-list",attrs:{name:"user-order-list","have-more":!s.loadDone},on:{"load-more":s.getMoreOrderList}}):t("el-pagination",{attrs:{"prev-text":"上一页","next-text":"下一页","current-page":s.page,"page-size":s.pageSize,layout:"prev, pager, next, jumper, total",total:s.currentTotal},on:{"current-change":s.getOrderList}})]:s._e()],2)},T=[],j=e("f8b7"),B=function(){var s=this,t=s._self._c;return t("div",{staticClass:"user-order"},[t("div",{staticClass:"top"},[t("div",{staticClass:"time"},[s._v(s._s(s.order.time))]),t("div",{staticClass:"order-num"},[s._v("兑换号: "+s._s(s.order.order))])]),t("div",{staticClass:"info"},[t("div",{staticClass:"cover"},[t("el-image",{staticClass:"order-img",attrs:{src:s.cover,width:"80",height:"80",alt:s.order.hobby.name,"preview-src-list":s.pictures}})],1),t("div",{staticClass:"hobby-info"},[t("div",{staticClass:"hobby-name"},[s._v(s._s(s.order.hobby.name))]),t("div",{staticClass:"spend"},[t("div",{staticClass:"point",class:s.platformClass},[s._v("积分: "+s._s(s.order.hobby.point))])])]),t("div",{staticClass:"count"},[s._v("数量: "+s._s(s.order.count))])]),t("div",{staticClass:"address"},[t("div",{staticClass:"label"},[s._v("收件人信息:")]),t("div",{staticClass:"address-info"},[t("div",{staticClass:"address-item"},[t("span",{staticClass:"address-item-label"},[s._v("收件人: ")]),t("span",{staticClass:"address-item-value"},[s._v(s._s(s.order.contact.receiver))])]),t("div",{staticClass:"address-item"},[t("span",{staticClass:"address-item-label"},[s._v("收件号码: ")]),t("span",{staticClass:"address-item-value"},[s._v(s._s(s.order.contact.tel))])]),t("div",{staticClass:"address-item"},[t("span",{staticClass:"address-item-label"},[s._v("收件地址: ")]),t("span",{staticClass:"address-item-value"},[s._v(s._s(s.order.contact.addr))])]),t("div",{staticClass:"address-item"},[t("span",{staticClass:"address-item-label"},[s._v("淘宝账号: ")]),t("span",{staticClass:"address-item-value"},[s._v(s._s(s.order.contact.tb_account))])])])])])},M=[],z={name:"user-order",props:["order"],computed:{mainUser(){return this.order.support.find(s=>"main"===s.role)||{}},mainUserLink(){return"/space/"+this.mainUser.user.uid},cover(){return this.order.hobby.pictures.length?this.order.hobby.pictures[0]:"https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg"},pictures(){return this.order.hobby.pictures.length?this.order.hobby.pictures:["https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg"]},platformClass(){switch(this.order.hobby.platform){case 1:return"douyu";case 2:return"bilibili";case 3:return"community"}return"douyu"},platform(){switch(this.order.hobby.platform){case 1:return"斗鱼";case 2:return"B站";case 3:return"双平台"}return"斗鱼"}}},H=z,S=(e("aff5"),Object(p["a"])(H,B,M,!1,null,"fc8e7548",null)),D=S.exports,I=function(){var s=this,t=s._self._c;return t("div",{staticClass:"borrow-order"},[t("div",{staticClass:"top"},[t("div",{staticClass:"time"},[s._v(s._s(s.order.time))]),t("div",{staticClass:"order-num"},[s._v("兑换号: "+s._s(s.order.order))])]),t("div",{staticClass:"info"},[t("div",{staticClass:"hobby"},[t("div",{staticClass:"cover"},[t("el-image",{staticClass:"order-img",attrs:{src:s.cover,width:"80",height:"80",alt:s.order.hobby.name,"preview-src-list":s.pictures}})],1),t("div",{staticClass:"hobby-info"},[t("div",{staticClass:"hobby-name"},[s._v(s._s(s.order.hobby.name))]),t("div",{staticClass:"description"},[t("div",[s._v(s._s(s.order.hobby.description))])])])]),t("div",{staticClass:"borrow-info"},[t("div",{staticClass:"borrow-from"},[s._v(" 借分人: "),t("a",{staticClass:"user",attrs:{href:"/space/"+s.order.user.uid,target:"_blank"}},[s._v(s._s(s.order.user.nickname))])]),t("div",{staticClass:"borrow-point"},[s._v("借用积分: "+s._s(s.order.lend))])]),t("div",{staticClass:"operations"},[t("h-button",{attrs:{size:"small",type:"primary"},on:{click:s.agree}},[s._v("同意")]),t("h-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"danger"},on:{click:s.refuse}},[s._v("拒绝")])],1)])])},E=[],N=e("dbbe"),U={name:"borrow-order",props:["order"],components:{HButton:N["a"]},computed:{cover(){return this.order.hobby.pictures.length?this.order.hobby.pictures[0]:"https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg"},pictures(){return this.order.hobby.pictures.length?this.order.hobby.pictures:["https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg"]},platformClass(){switch(this.order.hobby.platform){case 1:return"douyu";case 2:return"bilibili";case 3:return"community"}return"douyu"},platform(){switch(this.order.hobby.platform){case 1:return"斗鱼";case 2:return"B站";case 3:return"双平台"}return"斗鱼"}},methods:{agree(){this.$emit("agree",this.order.order)},refuse(){this.$emit("refuse",this.order.order)}}},J=U,P=(e("8a97"),Object(p["a"])(J,I,E,!1,null,"0c313147",null)),q=P.exports,F={name:"manage",data(){return{page:1,pageSize:10,orderList:[],total:0,total0:0,total1:0,total2:0,total3:0,total4:0,total5:0,borrowTotal:0,loadDone:!1,loading:!1}},components:{UserOrder:D,LoadMore:v["a"],BorrowOrder:q},computed:{...Object(i["d"])({isMobile:s=>s.media.isMobile}),status(){const s=Number(this.$route.query.status);return[0,1,2,3,4,5,-1,10].includes(s)?s:0},orderNav(){return[{status:0,text:"待审核",count:this.total0},{status:1,text:"待发货",count:this.total1},{status:2,text:"已发货",count:this.total2},{status:5,text:"待确认",count:this.total5},{status:3,text:"已拒绝",count:this.total3},{status:4,text:"已完成",count:this.total4},{status:-1,text:"全部订单",count:this.total},{status:10,text:"借分订单",count:this.borrowTotal}]},currentTotal(){switch(this.status){case 0:return this.total0;case 1:return this.total1;case 2:return this.total2;case 3:return this.total3;case 4:return this.total4;case 5:return this.total5;case 10:return this.borrowTotal}return this.total}},watch:{status(){this.reset(),10!==this.status?this.getOrderList():this.getBorrowList()}},methods:{getOrderList(){this.loading||(this.loading=!0,n["a"].get(j["a"].orderList,{params:{page:this.page,pageSize:this.pageSize,status:this.status}}).then(s=>{0===s.code&&(this.total=s.total,this.total0=s.statusTotal[0],this.total1=s.statusTotal[1],this.total2=s.statusTotal[2],this.total3=s.statusTotal[3],this.total4=s.statusTotal[4],this.total5=s.statusTotal[5],this.borrowTotal=s.borrowTotal,10!==this.status&&(this.isMobile?this.orderList.push(...s.list):this.orderList=s.list,s.list.length<this.pageSize&&(this.loadDone=!0))),this.loading=!1}))},getBorrowList(){n["a"].get(j["a"].borrowList).then(s=>{0===s.code&&(this.orderList=s.list)})},getMoreOrderList(){this.getOrderList(),this.page++},isSelected(s){const t=Number(s);return this.orderNav.find(s=>s.status===this.status)?t===this.status:0===s},reset(){this.page=1,this.orderList=[]},agree(s){this.$confirm("同意后系统将会扣除相应积分,请核对后操作","同意借分",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{n["a"].post(j["a"].checkBorrow,{agree:1,order:s}).then(s=>{0===s.code?this.$message({type:"success",message:s.msg}):this.$message({type:"warning",message:s.msg}),this.getOrderList(),this.getBorrowList()})}).catch(()=>{this.$message({type:"success",message:"已取消操作~"})})},refuse(s){this.$confirm("拒绝后会导致订单失败,请核对后操作","拒绝借分",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{n["a"].post(j["a"].checkBorrow,{agree:0,order:s}).then(s=>{0===s.code?this.$message({type:"success",message:s.msg}):this.$message({type:"warning",message:s.msg}),this.getOrderList(),this.getBorrowList()})}).catch(()=>{this.$message({type:"success",message:"已取消操作~"})})}},mounted(){this.isMobile||(this.getOrderList(),10===this.status&&this.getBorrowList())}},G=F,K=(e("f84b"),Object(p["a"])(G,O,T,!1,null,"e2f4c49a",null)),Q=K.exports,R=function(){var s=this,t=s._self._c;return t("div",{staticClass:"addres"},[t("div",{staticClass:"operations"},[t("h-button",{on:{click:s.showAddAddress}},[s._v("添加地址")])],1),s.addressList.length?[t("div",{staticClass:"address-wrapper"},s._l(s.addressList,(function(e){return t("div",{key:e.id,staticClass:"address"},[t("div",{staticClass:"operations"},[t("h-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return s.showEditAddress(e)}}},[t("i",{staticClass:"iconfont fatie"})]),t("h-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"danger"},on:{click:function(t){return s.deleteAddress(e.id)}}},[t("i",{staticClass:"iconfont shanchu"})])],1),t("h4",[s._v(s._s(e.name))]),t("div",{staticClass:"address-item-short"},[t("div",{staticClass:"address-label-short"},[s._v("收件人")]),t("p",[s._v(s._s(e.receiver))])]),t("div",{staticClass:"address-item-short"},[t("div",{staticClass:"address-label-short"},[s._v("电话号码")]),t("p",[s._v(s._s(e.tel))])]),t("div",{staticClass:"address-item-short"},[t("div",{staticClass:"address-label-short"},[s._v("收件地址")]),t("p",[s._v(s._s(e.addr))])]),t("div",{staticClass:"address-item-short"},[t("div",{staticClass:"address-label-short"},[s._v("淘宝账号")]),t("p",[s._v(s._s(e.tb_account))])])])})),0)]:t("div",{staticClass:"no-data"},[s._v("暂无地址")]),t("el-dialog",{attrs:{title:s.actionTitle,visible:s.showAddress,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){s.showAddress=t},closed:s.resetAddressInfo}},[t("p",{staticClass:"introduction"},[s._v(" 以下信息均为选填，在兑换时选中对应地址可快捷填入已有信息。请仔细检查填写信息，订单提交后将不能修改收件人信息。 ")]),t("div",{staticClass:"address-item"},[t("div",{staticClass:"address-label"},[s._v("名称")]),t("h-input",{staticClass:"address-record input",attrs:{maxlength:20,placeholder:"家，学校，办公室等"},model:{value:s.selectedAddress.name,callback:function(t){s.$set(s.selectedAddress,"name",t)},expression:"selectedAddress.name"}})],1),t("div",{staticClass:"address-item"},[t("div",{staticClass:"address-label"},[s._v("收件人")]),t("h-input",{staticClass:"address-record input",attrs:{maxlength:20},model:{value:s.selectedAddress.receiver,callback:function(t){s.$set(s.selectedAddress,"receiver",t)},expression:"selectedAddress.receiver"}})],1),t("div",{staticClass:"address-item"},[t("div",{staticClass:"address-label"},[s._v("电话号码")]),t("h-input",{staticClass:"address-record input",model:{value:s.selectedAddress.tel,callback:function(t){s.$set(s.selectedAddress,"tel",t)},expression:"selectedAddress.tel"}})],1),t("div",{staticClass:"address-item"},[t("div",{staticClass:"address-label"},[s._v("收件地址")]),t("h-input",{staticClass:"address-record input",attrs:{maxlength:200},model:{value:s.selectedAddress.addr,callback:function(t){s.$set(s.selectedAddress,"addr",t)},expression:"selectedAddress.addr"}})],1),t("div",{staticClass:"address-item"},[t("div",{staticClass:"address-label"},[s._v("淘宝账号")]),t("h-input",{staticClass:"address-record input",attrs:{placeholder:"兑换专辑时需要"},model:{value:s.selectedAddress.tb_account,callback:function(t){s.$set(s.selectedAddress,"tb_account",t)},expression:"selectedAddress.tb_account"}})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("h-button",{staticStyle:{"margin-right":"20px"},attrs:{size:"small",plain:""},on:{click:function(t){s.showAddress=!1}}},[s._v("取 消")]),t("h-button",{attrs:{size:"small",type:"primary"},on:{click:s.addressAction}},[s._v("确 定")])],1)])],2)},V=[],W=e("6275"),X=e("2f94"),Y={name:"addres",data(){return{addressList:[],action:0,showAddress:!1,id:0,selectedAddress:{name:"",receiver:"",tel:"",addr:"",tb_account:""}}},components:{HButton:N["a"],HInput:W["a"]},computed:{actionTitle(){return 0===this.action?"添加地址":"编辑地址"}},methods:{getAddressList(){n["a"].get(X["a"].addressList).then(s=>{0===s.code?this.addressList=s.list:this.$message({type:"warning",message:s.msg})})},showAddAddress(){this.showAddress=!0,this.action=0},resetAddressInfo(){this.selectedAddress.name="",this.selectedAddress.receiver="",this.selectedAddress.tel="",this.selectedAddress.addr="",this.selectedAddress.tb_account=""},addressAction(){0===this.action?this.addAddress():this.editAddress()},addAddress(){n["a"].post(X["a"].addAddress,this.selectedAddress).then(s=>{0===s.code?(this.$message({type:"success",message:s.msg}),this.showAddress=!1,this.resetAddressInfo(),this.getAddressList()):this.$message({type:"warning",message:s.msg})})},showEditAddress(s){this.selectedAddress.name=s.name,this.selectedAddress.receiver=s.receiver,this.selectedAddress.tel=s.tel,this.selectedAddress.addr=s.addr,this.selectedAddress.tb_account=s.tb_account,this.id=s.id,this.action=1,this.showAddress=!0},editAddress(){n["a"].post(X["a"].editAddress,Object.assign({},this.selectedAddress,{id:this.id})).then(s=>{0===s.code?(this.$message({type:"success",message:s.msg}),this.showAddress=!1,this.resetAddressInfo(),this.getAddressList()):this.$message({type:"warning",message:s.msg})})},deleteAddress(s){this.$confirm("确认删除","删除地址",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{n["a"].post(X["a"].deleteAddress,{id:s}).then(s=>{0===s.code?(this.$message({type:"success",message:s.msg}),this.showAddress=!1,this.resetAddressInfo(),this.getAddressList()):this.$message({type:"warning",message:s.msg})})}).catch(()=>{this.$message({type:"success",message:"已取消删除~"})})}},mounted(){this.getAddressList()}},Z=Y,ss=(e("6aa5"),Object(p["a"])(Z,R,V,!1,null,"20464dce",null)),ts=ss.exports,es={name:"score",data(){return{navList:[{text:"积分兑换",hash:"#exchange"},{text:"我的积分",hash:"#point"},{text:"兑换管理",hash:"#manage"},{text:"地址管理",hash:"#address"}]}},components:{Point:$,Manage:Q,Exchange:C,Addres:ts},computed:{...Object(i["d"])({user:s=>s.users.userInfo}),...Object(i["b"])("users",{isAdmin:"isAdmin",isHanser:"isHanser",isHobbyscore:"isHobbyscore"}),navItem(){const{hash:s}=this.$route;switch(s){case"#manage":return Q;case"#point":return $;case"#exchange":return C;case"#address":return ts}return C}},methods:{checkSelected(s){const t=this.$route.hash,e=this.navList.find(s=>s.hash===t);return e?s===e.hash:s===this.navList[0].hash}}},as=es,rs=(e("9aa4"),Object(p["a"])(as,a,r,!1,null,"f2bccbbc",null));t["default"]=rs.exports},f84b:function(s,t,e){"use strict";e("0a3a")},f8b7:function(s,t,e){"use strict";t["a"]={orderList:"/order/list",allOrder:"/order/all/list",checkOrder:"/order/check",deliverOrder:"/order/deliver",checkMultiOrder:"/order/check/multi",borrowList:"/order/borrow/list",checkBorrow:"/user/check/borrow"}}}]);