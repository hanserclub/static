(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0901f3c0"],{"00e5":function(t,e,s){"use strict";s("f20b")},"08dd":function(t,e,s){},"0943":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"manager"},[e("div",{staticClass:"manager-wrapper"},[e("nav",{staticClass:"manager-nav"},[t._l(t.navList,(function(s){return[s.show?e("router-link",{key:s.hash,class:{"nav-item":!0,selected:t.checkSelected(s.hash)},attrs:{to:t.$route.path+s.hash,replace:""}},[t._v(" "+t._s(s.text)+" ")]):t._e()]}))],2),e(t.navItem,{tag:"component",staticClass:"content-wrapper"})],1)])},i=[],o=(s("0643"),s("fffc"),s("2f62")),n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"point"},[e("div",{staticClass:"header"},[e("div",{staticClass:"score-nav--wrapper"},t._l(t.scoreNav,(function(s){return e("router-link",{key:s.type,class:{"nav-item":!0,selected:t.isSelected(s.type)},attrs:{replace:"",to:`${t.$route.path}?type=${s.type}${t.$route.hash}`},nativeOn:{click:function(e){return t.clearKeyword.apply(null,arguments)}}},[t._v(" "+t._s(s.text)+" "),s.count?e("span",[t._v("("+t._s(s.count)+")")]):t._e()])})),1),e("div",{staticClass:"search-and-add"},[e("h-input",{staticClass:"search-input",attrs:{placeholder:"搜索uid,昵称"},on:{input:t.search},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),2!==t.type&&3!==t.type?e("h-button",{on:{click:t.showAddUser}},[t._v("添加用户")]):t._e()],1)]),e(t.scoreShown,{ref:"pointChild",tag:"component",attrs:{keyword:t.keyword},on:{"change-score":t.changeScore,"search-log":t.searchLog,"total-cahnge":t.changeTotal}}),e("el-dialog",{attrs:{title:"新增积分记录",visible:t.changeScoreVisible,"close-on-click-modal":!1,"append-to-body":!0,width:"40%"},on:{"update:visible":function(e){t.changeScoreVisible=e},closed:t.resetInfo}},[e("div",{staticClass:"user-info"},[e("div",{staticClass:"avatar"},[e("img",{attrs:{referrerPolicy:"no-referrer",src:t.scoreUser.avatar,width:"50",height:"50"}})]),e("span",{class:["douyu"===t.scoreUser.site?"douyu":"bilibili","username"]},[t._v(t._s(t.scoreUser.nickname))])]),e("div",{staticClass:"info-input"},[e("div",{staticClass:"label"},[t._v("变更分值")]),e("h-input",{staticClass:"input offset",attrs:{placeholder:"请录入本次变更积分"},model:{value:t.commitInfo.offset,callback:function(e){t.$set(t.commitInfo,"offset",e)},expression:"commitInfo.offset"}}),e("div",{staticClass:"label"},[t._v("原因备注")]),e("h-input",{staticClass:"input note",attrs:{placeholder:"请录入本次积分变更原因或选择以下历史记录一键备注"},model:{value:t.commitInfo.note,callback:function(e){t.$set(t.commitInfo,"note",e)},expression:"commitInfo.note"}})],1),e("div",{staticClass:"notes"},t._l(t.notes,(function(s){return e("el-tag",{key:s.id,staticClass:"tag",attrs:{closable:"",type:""},on:{click:function(e){return t.setNote(s.note)},close:function(e){return t.deleteNote(s.id)}}},[t._v(" "+t._s(s.note)+" ")])})),1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("h-button",{staticStyle:{"margin-right":"20px"},attrs:{plain:""},on:{click:function(e){t.changeScoreVisible=!1}}},[t._v("取 消")]),e("h-button",{attrs:{debonus:1e3},on:{click:t.commitChange}},[t._v("确 定")])],1)]),e("el-dialog",{attrs:{title:"新增积分用户",visible:t.addUserVisible,"close-on-click-modal":!1,"append-to-body":!0,width:"40%"},on:{"update:visible":function(e){t.addUserVisible=e},closed:t.resetAddInfo}},[e("div",{staticClass:"user-platform--info"},[e("h-input",{staticClass:"input uid",attrs:{placeholder:"请录入用户B站UID,回车确认"},on:{blur:t.getUserInfo,"enter-press":t.getUserInfo},model:{value:t.addUserInfo.uid,callback:function(e){t.$set(t.addUserInfo,"uid",e)},expression:"addUserInfo.uid"}}),t.addUserInfo.avatar?e("div",{staticClass:"user-info"},[e("div",{staticClass:"avatar"},[e("img",{attrs:{referrerPolicy:"no-referrer",src:t.addUserInfo.avatar,width:"50",height:"50"}})]),e("span",{staticClass:"bilibili username"},[t._v(t._s(t.addUserInfo.name))])]):t._e()],1),e("div",{staticClass:"info-input"},[e("div",{staticClass:"label"},[t._v("初始积分")]),e("h-input",{staticClass:"input offset",attrs:{placeholder:"请录入用户初始积分"},model:{value:t.addUserInfo.point,callback:function(e){t.$set(t.addUserInfo,"point",e)},expression:"addUserInfo.point"}}),e("div",{staticClass:"label"},[t._v("原因备注")]),e("h-input",{staticClass:"input note",attrs:{placeholder:"请录入本次积分变更原因或选择以下历史记录一键备注"},model:{value:t.addUserInfo.note,callback:function(e){t.$set(t.addUserInfo,"note",e)},expression:"addUserInfo.note"}})],1),e("div",{staticClass:"notes"},t._l(t.notes,(function(s){return e("el-tag",{key:s.id,staticClass:"tag",attrs:{closable:"",type:""},on:{click:function(e){return t.setAddNote(s.note)},close:function(e){return t.deleteNote(s.id)}}},[t._v(" "+t._s(s.note)+" ")])})),1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("h-button",{staticStyle:{"margin-right":"20px"},attrs:{plain:""},on:{click:function(e){t.addUserVisible=!1}}},[t._v("取 消")]),e("h-button",{attrs:{type:"primary",debonus:1e3},on:{click:t.commitAdd}},[t._v("确 定")])],1)])],1)},r=[],l=(s("2382"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"all"},[e("el-table",{attrs:{data:t.list,"default-sort":{prop:"point",order:"descending"},stripe:""},on:{"sort-change":t.sortChange}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"100"}}),e("el-table-column",{attrs:{width:"120",label:"积分账户平台"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{class:["douyu"===s.row.site?"douyu":"bilibili"]},[t._v(t._s("douyu"===s.row.site?"斗鱼":"B站"))])]}}])}),e("el-table-column",{attrs:{label:"积分账户名称"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{class:["douyu"===s.row.site?"douyu":"bilibili"],attrs:{href:s.row.homepage,target:"_blank"}},[t._v(t._s(s.row.name))])]}}])}),e("el-table-column",{attrs:{width:"120",label:"俱乐部昵称"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.bind?e("a",{staticClass:"community",attrs:{href:"/space/"+s.row.bind.uid,target:"_blank"}},[t._v(t._s(s.row.bind.nickname))]):e("span",[t._v("暂未注册")])]}}])}),e("el-table-column",{attrs:{width:"120",prop:"point",sortable:"custom",label:"积分余额"}}),e("el-table-column",{attrs:{width:"170",prop:"update",sortable:"custom",label:"更新日期"}}),e("el-table-column",{attrs:{width:"180",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"operation",on:{click:function(e){return t.changeScore(s.row)}}},[t._v("加扣分")]),e("div",{staticClass:"operation",on:{click:function(e){return t.showLog(s.row)}}},[t._v("查看日志")])]}}])})],1),e("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.params.page,"page-size":t.params.pageSize,"page-sizes":[10,15,20,30],layout:"total, prev, pager, next, jumper, sizes",total:t.total},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"update:pageSize":function(e){return t.$set(t.params,"pageSize",e)},"update:page-size":function(e){return t.$set(t.params,"pageSize",e)},"size-change":t.sizeChange,"current-change":t.currentChange}})],1)}),c=[],u=s("db04"),h={scoreCount:"/score/count",scoreList:"/score/list",scoreNote:"/score/note",deleteScoreNote:"/score/note/delete",scoreChange:"/score/change",scoreLog:"/score/log",getBilibiliUser:"/forward/getBilibiliUser",addScore:"/score/add"},d={name:"all",props:["keyword"],data(){return{params:{page:1,pageSize:10,site:"",sort:"point",order:"DESC",keyword:""},total:0,list:[]}},watch:{keyword(){this.params.keyword=this.keyword,this.params.page=1,this.getAllAccount()}},methods:{getAllAccount(){u["a"].get(h.scoreList,{params:this.params}).then(t=>{0===t.code?(this.list=t.list,this.total=t.total,this.$emit("total-cahnge",{key:"total",value:this.total})):this.$message({type:"warning",message:t.msg})})},sortChange({order:t,prop:e}){this.params.sort=e,this.params.order="ascending"===t?"ASC":"DESC",this.getAllAccount()},sizeChange(){this.params.page=1,this.getAllAccount()},currentChange(){this.getAllAccount()},changeScore(t){this.$emit("change-score",t)},showLog(t){this.$emit("search-log",t.uid),this.$router.replace({path:"/manager?type=3#point",query:{site:t.site,uid:t.uid}})}},mounted(){this.getAllAccount()}},b=d,p=(s("00e5"),s("2877")),m=Object(p["a"])(b,l,c,!1,null,"24fd6816",null),g=m.exports,y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bilibili"},[e("el-table",{attrs:{data:t.list,"default-sort":{prop:"point",order:"descending"},stripe:""},on:{"sort-change":t.sortChange}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"100"}}),e("el-table-column",{attrs:{width:"120",label:"积分账户平台"}},[[e("span",{staticClass:"bilibili"},[t._v(t._s("B站"))])]],2),e("el-table-column",{attrs:{label:"积分账户名称"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{staticClass:"bilibili",attrs:{href:s.row.homepage,target:"_blank"}},[t._v(t._s(s.row.name))])]}}])}),e("el-table-column",{attrs:{width:"120",label:"俱乐部昵称"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.bind?e("a",{staticClass:"community",attrs:{href:"/space/"+s.row.bind.uid,target:"_blank"}},[t._v(t._s(s.row.bind.nickname))]):e("span",[t._v("暂未注册")])]}}])}),e("el-table-column",{attrs:{width:"120",prop:"point",sortable:"custom",label:"积分余额"}}),e("el-table-column",{attrs:{width:"170",prop:"update",sortable:"custom",label:"更新日期"}}),e("el-table-column",{attrs:{width:"180",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"operation",on:{click:function(e){return t.changeScore(s.row)}}},[t._v("加扣分")]),e("div",{staticClass:"operation",on:{click:function(e){return t.showLog(s.row)}}},[t._v("查看日志")])]}}])})],1),e("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.params.page,"page-size":t.params.pageSize,"page-sizes":[10,15,20,30],layout:"total, prev, pager, next, jumper, sizes",total:t.total},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"update:pageSize":function(e){return t.$set(t.params,"pageSize",e)},"update:page-size":function(e){return t.$set(t.params,"pageSize",e)},"size-change":t.sizeChange,"current-change":t.currentChange}})],1)},f=[],v={name:"bilibili",props:["keyword"],data(){return{params:{page:1,pageSize:10,site:"bilibili",sort:"point",order:"DESC",keyword:""},total:0,list:[]}},watch:{keyword(){this.params.keyword=this.keyword,this.params.page=1,this.getAllAccount()}},methods:{getAllAccount(){u["a"].get(h.scoreList,{params:this.params}).then(t=>{0===t.code?(this.list=t.list,this.total=t.total,this.$emit("total-cahnge",{key:"bilibili",value:this.total})):this.$message({type:"warning",message:t.msg})})},sortChange({order:t,prop:e}){this.params.sort=e,this.params.order="ascending"===t?"ASC":"DESC",this.getAllAccount()},sizeChange(){this.params.page=1,this.getAllAccount()},currentChange(){this.getAllAccount()},changeScore(t){this.$emit("change-score",t)},showLog(t){this.$emit("search-log",t.uid),this.$router.replace({path:"/score?type=3#point",query:{site:t.site,uid:t.uid}})}},mounted(){this.getAllAccount()}},_=v,C=(s("8607"),Object(p["a"])(_,y,f,!1,null,"160bd086",null)),w=C.exports,k=function(){var t=this,e=t._self._c;return e("div",{staticClass:"douyu"},[e("el-table",{attrs:{data:t.list,"default-sort":{prop:"point",order:"descending"},stripe:""},on:{"sort-change":t.sortChange}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"100"}}),e("el-table-column",{attrs:{width:"120",label:"积分账户平台"}},[[e("span",{staticClass:"douyu"},[t._v(t._s("斗鱼"))])]],2),e("el-table-column",{attrs:{label:"积分账户名称"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{staticClass:"douyu",attrs:{href:s.row.homepage,target:"_blank"}},[t._v(t._s(s.row.name))])]}}])}),e("el-table-column",{attrs:{width:"120",label:"俱乐部昵称"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.bind?e("a",{staticClass:"community",attrs:{href:"/space/"+s.row.bind.uid,target:"_blank"}},[t._v(t._s(s.row.bind.nickname))]):e("span",[t._v("暂未注册")])]}}])}),e("el-table-column",{attrs:{width:"120",prop:"point",sortable:"custom",label:"积分余额"}}),e("el-table-column",{attrs:{width:"170",prop:"update",sortable:"custom",label:"更新日期"}}),e("el-table-column",{attrs:{width:"180",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"operation",on:{click:function(e){return t.changeScore(s.row)}}},[t._v("加扣分")]),e("div",{staticClass:"operation",on:{click:function(e){return t.showLog(s.row)}}},[t._v("查看日志")])]}}])})],1),e("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.params.page,"page-size":t.params.pageSize,"page-sizes":[10,15,20,30],layout:"total, prev, pager, next, jumper, sizes",total:t.total},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"update:pageSize":function(e){return t.$set(t.params,"pageSize",e)},"update:page-size":function(e){return t.$set(t.params,"pageSize",e)},"size-change":t.sizeChange,"current-change":t.currentChange}})],1)},x=[],I={name:"douyu",props:["keyword"],data(){return{params:{page:1,pageSize:10,site:"douyu",sort:"point",order:"DESC",keyword:""},total:0,list:[]}},watch:{keyword(){this.params.keyword=this.keyword,this.params.page=1,this.getAllAccount()}},methods:{getAllAccount(){u["a"].get(h.scoreList,{params:this.params}).then(t=>{0===t.code?(this.list=t.list,this.total=t.total,this.$emit("total-cahnge",{key:"douyu",value:this.total})):this.$message({type:"warning",message:t.msg})})},sortChange({order:t,prop:e}){this.params.sort=e,this.params.order="ascending"===t?"ASC":"DESC",this.getAllAccount()},sizeChange(){this.params.page=1,this.getAllAccount()},currentChange(){this.getAllAccount()},changeScore(t){this.$emit("change-score",t)},showLog(t){this.$emit("search-log",t.uid),this.$router.replace({path:"/score?type=3#point",query:{site:t.site,uid:t.uid}})}},mounted(){this.getAllAccount()}},$=I,S=(s("f56c"),Object(p["a"])($,k,x,!1,null,"5a21b017",null)),z=S.exports,U=function(){var t=this,e=t._self._c;return e("div",{staticClass:"log"},[e("el-table",{attrs:{data:t.list,"default-sort":{prop:"time",order:"descending"},stripe:""},on:{"sort-change":t.sortChange}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"100"}}),e("el-table-column",{attrs:{prop:"id",label:"ID",width:"50"}}),e("el-table-column",{attrs:{width:"120",label:"积分账户平台"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{class:["douyu"===s.row.site?"douyu":"bilibili"]},[t._v(t._s("douyu"===s.row.site?"斗鱼":" B站"))])]}}])}),e("el-table-column",{attrs:{label:"积分账户名称"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{class:["douyu"===s.row.site?"douyu":"bilibili"],attrs:{href:s.row.homepage,target:"_blank"}},[t._v(t._s(s.row.name))])]}}])}),e("el-table-column",{attrs:{width:"120",prop:"point",label:"积分变更"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{class:[s.row.point>0?"increase":"decrease"]},[t._v(" "+t._s(s.row.point>0?"+"+s.row.point:s.row.point)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"note",label:"备注"}}),e("el-table-column",{attrs:{width:"120",label:"操作人"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.operator?e("a",{staticClass:"community",attrs:{href:"/space/"+s.row.operator.uid,target:"_blank"}},[t._v(t._s(s.row.operator.nickname))]):e("span",[t._v("系统")])]}}])}),e("el-table-column",{attrs:{width:"170",prop:"time",sortable:"time",label:"更新日期"}})],1),e("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.params.page,"page-size":t.params.pageSize,"page-sizes":[10,15,20,30],layout:"total, prev, pager, next, jumper, sizes",total:t.total},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"update:pageSize":function(e){return t.$set(t.params,"pageSize",e)},"update:page-size":function(e){return t.$set(t.params,"pageSize",e)},"size-change":t.sizeChange,"current-change":t.currentChange}})],1)},L=[],A={name:"log",props:["keyword"],data(){return{params:{page:1,pageSize:10,order:"DESC",site:"",uid:"",keyword:""},total:0,list:[]}},watch:{keyword(){this.params.keyword=this.keyword,this.params.page=1,this.getAllLog()}},methods:{getAllLog(){u["a"].get(h.scoreLog,{params:this.params}).then(t=>{0===t.code?(this.list=t.list,this.total=t.total,this.$emit("total-cahnge",{key:"log",value:this.total})):this.$message({type:"warning",message:t.msg})})},sortChange({order:t}){this.params.order="ascending"===t?"ASC":"DESC",this.getAllLog()},sizeChange(){this.params.page=1,this.getAllLog()},currentChange(){this.getAllLog()}},mounted(){const{site:t,uid:e}=this.$route.query;("douyu"===t||"bilibili"===t&&e)&&(this.params.site=t,this.params.uid=Number(e)),this.getAllLog()}},H=A,O=(s("6f50"),Object(p["a"])(H,U,L,!1,null,"726bc968",null)),D=O.exports,T=s("dbbe"),N=s("6275"),B={name:"point",data(){return{countRaw:{bilibili:0,douyu:0,log:0,total:0},count:{bilibili:0,douyu:0,log:0,total:0},scoreUser:{site:"",uid:"",avatar:"",nickname:""},commitInfo:{site:"",uid:"",offset:"",note:""},searchText:"",keyword:"",noteKeyword:"",notes:[],timer:null,changeScoreVisible:!1,addUserVisible:!1,addUserInfo:{uid:"",name:"",avatar:"",point:"",note:""}}},components:{All:g,Bilibili:w,Douyu:z,Log:D,HInput:N["a"],HButton:T["a"]},computed:{scoreShown(){const{type:t}=this.$route.query;switch(t){case"0":return g;case"1":return w;case"2":return z;case"3":return D}return g},scoreNav(){return[{type:0,text:"全部账户",count:this.count.total},{type:1,text:"B站账户",count:this.count.bilibili},{type:2,text:"斗鱼账户",count:this.count.douyu},{type:3,text:"积分日志",count:this.count.log}]},type(){return Number(this.$route.query.type)}},methods:{getScoreCount(){u["a"].get(h.scoreCount).then(t=>{0===t.code&&(this.count.bilibili=t.bilibili,this.count.douyu=t.douyu,this.count.log=t.log,this.count.total=t.total,this.countRaw.bilibili=t.bilibili,this.countRaw.douyu=t.douyu,this.countRaw.log=t.log,this.countRaw.total=t.total)})},isSelected(t){const e=Number(t);return this.scoreNav.find(t=>t.type===this.type)?e===this.type:0===t},search(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{this.keyword=this.searchText},500)},changeScore(t){this.scoreUser.uid=t.uid,this.scoreUser.site=t.site,this.scoreUser.avatar=t.avatar,this.scoreUser.nickname=t.name,this.commitInfo.site=t.site,this.commitInfo.uid=t.uid,u["a"].get(h.scoreNote,{params:{keyword:this.noteKeyword}}).then(t=>{0===t.code?(this.notes=t.list,this.changeScoreVisible=!0):this.$message({type:"warning",message:t.msg})})},commitChange(){u["a"].post(h.scoreChange,this.commitInfo).then(t=>{0===t.code?(this.$message({type:"success",message:"修改成功"}),this.changeScoreVisible=!1,this.$refs.pointChild.getAllAccount(),this.getScoreCount()):this.$message({type:"warning",message:t.msg})})},deleteNote(t){u["a"].post(h.deleteScoreNote,{id:t}).then(e=>{0===e.code?(this.$message({type:"success",message:e.msg}),this.notes=this.notes.filter(e=>e.id!==t)):this.$message({type:"warning",message:e.msg})})},setNote(t){this.commitInfo.note=t},setAddNote(t){this.addUserInfo.note=t},resetInfo(){this.commitInfo.site="",this.commitInfo.uid="",this.commitInfo.offset="",this.commitInfo.note=""},clearKeyword(){this.searchText="",this.keyword="",clearTimeout(this.timer)},searchLog(t){this.searchText=String(t),this.keyword=String(t)},showAddUser(){u["a"].get(h.scoreNote,{params:{keyword:this.noteKeyword}}).then(t=>{0===t.code?(this.notes=t.list,this.addUserVisible=!0):this.$message({type:"warning",message:t.msg})})},resetAddInfo(){this.addUserInfo.uid="",this.addUserInfo.name="",this.addUserInfo.avatar="",this.addUserInfo.point=""},getUserInfo(){u["a"].get(h.getBilibiliUser,{params:{uid:this.addUserInfo.uid}}).then(t=>{0===t.code?(this.addUserInfo.name=t.user.name,this.addUserInfo.avatar=t.user.avatar):this.$message({type:"warning",message:t.msg})})},commitAdd(){u["a"].post(h.addScore,this.addUserInfo).then(t=>{0===t.code?(this.$message({type:"success",message:"添加成功"}),this.addUserVisible=!1,this.getScoreCount(),this.$refs.pointChild.getAllAccount()):this.$message({type:"warning",message:t.msg})})},changeTotal({key:t,value:e}){this.count.bilibili=this.countRaw.bilibili,this.count.douyu=this.countRaw.douyu,this.count.log=this.countRaw.log,this.count.total=this.countRaw.total,this.count[t]=e}},mounted(){this.getScoreCount()}},M=B,j=(s("a388"),Object(p["a"])(M,n,r,!1,null,"3b25eb40",null)),V=j.exports,E=function(){var t=this;t._self._c;return t._m(0)},R=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"manager"},[e("div",{staticClass:"title"},[t._v("黑名单管理")]),e("div",{staticClass:"description"},[t._v("加入黑名单将自动退出登录，无法再登录，注销。")])])}],P={name:"manager"},q=P,K=(s("25db"),Object(p["a"])(q,E,R,!1,null,"874020b2",null)),G=K.exports,F=function(){var t=this,e=t._self._c;return e("div",{staticClass:"hobby"},[e("div",{staticClass:"header"},[e("div",{staticClass:"hobby-nav--wrapper"},t._l(t.filterList,(function(s){return e("router-link",{key:s.value,class:{"nav-item":!0,selected:t.isSelected(s.value)},attrs:{replace:"",to:`${t.$route.path}?type=${s.value}${t.$route.hash}`},nativeOn:{click:function(e){return t.refresh.apply(null,arguments)}}},[t._v(" "+t._s(s.text)+" "),s.count?e("span",[t._v("("+t._s(s.count)+")")]):t._e()])})),1),e("div",{staticClass:"search-and-add"},[e("h-button",{on:{click:t.showAddHobby}},[t._v("添加周边")])],1)]),e("div",{staticClass:"hobby-list"},t._l(t.hobbyList,(function(s){return e("hobby-display",{key:s.id,attrs:{user:t.user,hobby:s,status:t.type},on:{"delete-hobby":t.deleteHobby,"set-on-hobby":t.setOnHobby,"set-down-hobby":t.setDownHobby,"edit-hobby":t.editHobby}})})),1),e("div",{staticClass:"hobby-pagination"},[e("el-pagination",{attrs:{"prev-text":"上一页","next-text":"下一页","current-page":t.page,"page-size":t.pageSize,layout:"prev, pager, next, jumper, total",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),e("el-dialog",{attrs:{title:"添加周边",visible:t.addHobbyVisible,"close-on-click-modal":!1,"append-to-body":!0,width:"60%"},on:{"update:visible":function(e){t.addHobbyVisible=e},closed:t.resetInfo}},[e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("周边名称")]),e("h-input",{staticClass:"hobby-record hobby-input",model:{value:t.hobbyInfo.name,callback:function(e){t.$set(t.hobbyInfo,"name",e)},expression:"hobbyInfo.name"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("周边描述")]),e("h-input",{staticClass:"hobby-record hobby-input",model:{value:t.hobbyInfo.description,callback:function(e){t.$set(t.hobbyInfo,"description",e)},expression:"hobbyInfo.description"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("所需积分")]),e("h-input",{staticClass:"hobby-record hobby-input",model:{value:t.hobbyInfo.point,callback:function(e){t.$set(t.hobbyInfo,"point",e)},expression:"hobbyInfo.point"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("展示图片(可不传)")]),e("input",{ref:"upload",staticClass:"hobby-input",attrs:{multiple:"",type:"file",accept:"image/*"},on:{change:t.uploadImage}})]),t.uploadImages.length?e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label hidden-label"}),e("div",{staticClass:"hobby-input"},t._l(t.uploadImages,(function(s,a){return e("div",{key:s,staticClass:"upload-image"},[e("div",{staticClass:"upload-single-image-wrapper"},[e("el-image",{staticClass:"hobby-image",attrs:{src:s,"preview-src-list":t.uploadImages}}),e("div",{staticClass:"upload-image-operations"},[0!==a?e("h-button",{attrs:{size:"mini"},on:{click:function(e){return t.moveUp(a)}}},[e("i",{staticClass:"iconfont shangyi1"})]):t._e(),a!==t.uploadImages.length-1?e("h-button",{attrs:{size:"mini"},on:{click:function(e){return t.moveDown(a)}}},[e("i",{staticClass:"iconfont shangyi"})]):t._e(),e("h-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.deleteUploadImage(a)}}},[e("i",{staticClass:"iconfont shanchu"})])],1)],1)])})),0)]):t._e(),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("库存")]),e("h-input",{staticClass:"hobby-record hobby-input",attrs:{placeholder:"0或不输入为不限制数量"},model:{value:t.hobbyInfo.count,callback:function(e){t.$set(t.hobbyInfo,"count",e)},expression:"hobbyInfo.count"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("单人最大可兑换数")]),e("h-input",{staticClass:"hobby-record hobby-input",attrs:{placeholder:"0或不输入为不限制数量"},model:{value:t.hobbyInfo.max,callback:function(e){t.$set(t.hobbyInfo,"max",e)},expression:"hobbyInfo.max"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("过期时间")]),e("el-date-picker",{attrs:{type:"datetime",placeholder:"不选择为不过期"},model:{value:t.hobbyInfo.expire,callback:function(e){t.$set(t.hobbyInfo,"expire",e)},expression:"hobbyInfo.expire"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("虚拟周边")]),e("h-radio-group",{staticClass:"hobby-input",model:{value:t.hobbyInfo.virtual,callback:function(e){t.$set(t.hobbyInfo,"virtual",e)},expression:"hobbyInfo.virtual"}},[e("h-radio",{attrs:{border:"",value:0,label:"否"}}),e("h-radio",{attrs:{border:"",value:1,label:"是"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("h-button",{staticStyle:{"margin-right":"20px"},attrs:{plain:""},on:{click:function(e){t.addHobbyVisible=!1}}},[t._v("取 消")]),e("h-button",{attrs:{type:"primary",debonus:1e3},on:{click:t.commitAddHobby}},[t._v("确 定")])],1)])],1)},J=[],Q=(s("14d9"),s("a573"),s("7551")),W=function(){var t=this,e=t._self._c;return e("div",{staticClass:"hobby-display"},[e("div",{staticClass:"hobby-info"},[e("div",{staticClass:"hobby-pic"},[t.hobby.pictures.length?e("el-image",{attrs:{src:t.hobby.pictures[0],"preview-src-list":t.hobby.pictures,width:"120",height:"120",fit:"cover",alt:"周边图片"}}):e("el-image",{attrs:{src:"https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg",fit:"cover",width:"120",height:"120",alt:"周边图片"}})],1),e("div",{staticClass:"hobby-base--info"},[e("div",{staticClass:"hobby-status"},[e("span",{staticClass:"hobby-name"},[t._v(t._s(t.hobby.name))]),t._l(t.statusList,(function(s){return e("span",{key:s.text,staticClass:"hobby-status--text",class:s.class},[t._v(t._s(s.text))])}))],2),t.hobby.description?e("div",{staticClass:"hobby-description"},[t._v(t._s(t.hobby.description))]):t._e(),e("div",{staticClass:"hobby-limitation"},[e("div",{staticClass:"hobby-limitation--item"},[t._v(" 积分 "),e("span",{staticClass:"hobby-limitation--item__value",class:t.siteClass},[t._v(t._s(t.hobby.point))])]),e("div",{staticClass:"hobby-limitation--item"},[t._v(" 预设库存 "),e("span",[t._v(t._s(t.hobby.count||"不限制"))])]),t.hobby.count?e("div",{staticClass:"hobby-limitation--item"},[t._v(" 当前库存 "),e("span",[t._v(t._s(t.hobby.rest))])]):t._e(),t.hobby.max?e("div",{staticClass:"hobby-limitation--item"},[t._v(" 最多可兑换 "),e("span",[t._v(t._s(t.hobby.max))]),t._v(" 件 ")]):t._e(),e("div",{staticClass:"hobby-limitation--item"},[t._v(" 兑换截止 "),e("span",[t._v(t._s(t.hobby.expire||"无截止日期"))])])]),e("div",{staticClass:"hobby-data"},[e("div",{staticClass:"hobby-limitation--item"},[t._v(" 讨论 "),e("span",[t._v(t._s(t.hobby.comments))])])])])]),e("div",{staticClass:"hobby-operations"},[1===t.status?e("h-button",{attrs:{debonus:1e3,size:"small"},on:{click:t.showEdit}},[t._v("编辑")]):t._e(),1===t.status?e("h-button",{attrs:{debonus:1e3,size:"small"},on:{click:t.setOnHobby}},[t._v("上架")]):t._e(),0===t.status?e("h-button",{attrs:{debonus:1e3,size:"small"},on:{click:t.setDownHobby}},[t._v("下架")]):t._e(),1===t.status?e("h-button",{attrs:{debonus:1e3,type:"danger",size:"small"},on:{click:t.deleteHobby}},[t._v("删除")]):t._e()],1),e("el-dialog",{attrs:{title:"编辑周边",visible:t.editVisible,"close-on-click-modal":!1,"append-to-body":!0,width:"60%"},on:{"update:visible":function(e){t.editVisible=e},closed:t.resetInfo}},[e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("周边名称")]),e("h-input",{staticClass:"hobby-record hobby-input",model:{value:t.editInfo.name,callback:function(e){t.$set(t.editInfo,"name",e)},expression:"editInfo.name"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("周边描述")]),e("h-input",{staticClass:"hobby-record hobby-input",model:{value:t.editInfo.description,callback:function(e){t.$set(t.editInfo,"description",e)},expression:"editInfo.description"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("所需积分")]),e("h-input",{staticClass:"hobby-record hobby-input",model:{value:t.editInfo.point,callback:function(e){t.$set(t.editInfo,"point",e)},expression:"editInfo.point"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("展示图片(可不传)")]),e("input",{ref:"upload",staticClass:"hobby-input",attrs:{multiple:"",type:"file",accept:"image/*"},on:{change:t.uploadImage}})]),t.editInfo.pictures.length?e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label hidden-label"}),e("div",{staticClass:"hobby-input"},t._l(t.editInfo.pictures,(function(s,a){return e("div",{key:s,staticClass:"upload-image"},[e("div",{staticClass:"upload-single-image-wrapper"},[e("el-image",{staticClass:"hobby-image",attrs:{src:s,"preview-src-list":t.editInfo.pictures}}),e("div",{staticClass:"upload-image-operations"},[0!==a?e("h-button",{attrs:{size:"mini"},on:{click:function(e){return t.moveUp(a)}}},[e("i",{staticClass:"iconfont shangyi1"})]):t._e(),a!==t.editInfo.pictures.length-1?e("h-button",{attrs:{size:"mini"},on:{click:function(e){return t.moveDown(a)}}},[e("i",{staticClass:"iconfont shangyi"})]):t._e(),e("h-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.deleteUploadImage(a)}}},[e("i",{staticClass:"iconfont shanchu"})])],1)],1)])})),0)]):t._e(),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("库存")]),e("h-input",{staticClass:"hobby-record hobby-input",attrs:{placeholder:"0或不输入为不限制数量"},model:{value:t.editInfo.count,callback:function(e){t.$set(t.editInfo,"count",e)},expression:"editInfo.count"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("单人最大可兑换数")]),e("h-input",{staticClass:"hobby-record hobby-input",attrs:{placeholder:"0或不输入为不限制数量"},model:{value:t.editInfo.max,callback:function(e){t.$set(t.editInfo,"max",e)},expression:"editInfo.max"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("过期时间")]),e("el-date-picker",{attrs:{type:"datetime",placeholder:"不选择为不过期"},model:{value:t.editInfo.expire,callback:function(e){t.$set(t.editInfo,"expire",e)},expression:"editInfo.expire"}})],1),e("div",{staticClass:"hobby-item"},[e("div",{staticClass:"hobby-label"},[t._v("虚拟周边")]),e("h-radio-group",{staticClass:"hobby-input",model:{value:t.editInfo.virtual,callback:function(e){t.$set(t.editInfo,"virtual",e)},expression:"editInfo.virtual"}},[e("h-radio",{attrs:{border:"",value:0,label:"否"}}),e("h-radio",{attrs:{border:"",value:1,label:"是"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("h-button",{staticStyle:{"margin-right":"20px"},attrs:{plain:""},on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),e("h-button",{attrs:{type:"primary",debonus:1e3},on:{click:t.commitEditHobby}},[t._v("确 定")])],1)])],1)},X=[],Y=s("3786"),Z=s("5ee2"),tt=s("0e5c");const et=2592e5;var st={name:"hobby-display",props:["hobby","status","user"],data(){return{editVisible:!1,editInfo:{name:"",description:"",point:"",pictures:[],count:"",expire:"",max:"",virtual:0}}},components:{HButton:T["a"],HInput:N["a"],HRadio:Q["a"],HRadioGroup:Q["b"]},computed:{statusList(){if((0===this.hobby.count||this.hobby.rest>10)&&(!this.hobby.expire||new Date<new Date(this.hobby.expire)&&this.over3Day(new Date,new Date(this.hobby.expire))))return[{text:"可正常兑换",class:"hobby-status--normal"}];{const t=[];return this.hobby.rest<10&&0!==this.hobby.count&&(0===this.hobby.rest?t.push({text:"缺货",class:"hobby-status--danger"}):t.push({text:"库存紧张",class:"hobby-status--warning"})),this.hobby.expire&&new Date>new Date(this.hobby.expire)?t.push({text:"已超出兑换期限",class:"hobby-status--danger"}):this.hobby.expire&&this.over3Day(new Date,new Date(this.hobby.expire))&&t.push({text:"即将过期",class:"hobby-status--warning"}),t}},siteClass(){switch(this.hobby.platform){case 1:return"hobby-douyu";case 2:return"hobby-bilibili";case 3:return"hobby-both"}return""},platform(){switch(this.hobby.platform){case 1:return"斗鱼";case 2:return"B站";case 3:return"全部平台"}return""}},methods:{over3Day(t,e){return Math.abs(t.valueOf()-e.valueOf())>et},deleteHobby(){this.$confirm("此操作将永久删除该周边, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$emit("delete-hobby",this.hobby.id)}).catch(()=>{this.$message({type:"message",message:"已取消操作"})})},setOnHobby(){this.$confirm("即将上架该周边, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$emit("set-on-hobby",this.hobby.id)}).catch(()=>{this.$message({type:"message",message:"已取消操作"})})},setDownHobby(){this.$confirm("即将下架该周边, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$emit("set-down-hobby",this.hobby.id)}).catch(()=>{this.$message({type:"message",message:"已取消操作"})})},resetInfo(){this.editInfo={name:"",description:"",point:"",count:"",expire:"",pictures:[],max:"",virtual:0}},showEdit(){this.editInfo.name=this.hobby.name,this.editInfo.description=this.hobby.description,this.editInfo.point=String(this.hobby.point),this.editInfo.count=String(this.hobby.count),this.editInfo.expire=this.hobby.expire,this.editInfo.max=String(this.hobby.max),this.editInfo.virtual=this.hobby.virtual,this.editInfo.pictures=this.hobby.pictures,this.editVisible=!0},moveUp(t){const e=this.editInfo.pictures[t-1];this.editInfo.pictures[t-1]=this.editInfo.pictures[t],this.editInfo.pictures[t]=e,this.editInfo.pictures.splice(0,0)},moveDown(t){const e=this.editInfo.pictures[t+1];this.editInfo.pictures[t+1]=this.editInfo.pictures[t],this.editInfo.pictures[t]=e,this.editInfo.pictures.splice(0,0)},deleteUploadImage(t){this.editInfo.pictures.splice(t,1)},async uploadImage(t){const e=await u["a"].get(Y["a"].upload);if(0!==e.code)return;const{auth:s,token:a}=e;try{const e=await tt["a"].uploadMultiFiles(Array.from(t.target.files),a,this.user.uid,s,(t,e)=>{this.$showProcess({title:"图片上传中...",value:t,max:e})},!1),i=e.map(t=>t.thumbnail);this.editInfo.pictures.push(...i)}catch(t){console.log(t)}},commitEditHobby(){u["a"].post(Z["a"].hobbyEdit,{id:this.hobby.id,name:this.editInfo.name,description:this.editInfo.description,point:Number(this.editInfo.point),pictures:this.editInfo.pictures,count:Number(this.editInfo.count),expire:this.editInfo.expire,max:Number(this.editInfo.max),virtual:this.editInfo.virtual}).then(t=>{0===t.code?(this.$message({type:"success",message:t.msg}),this.editVisible=!1):this.$message({type:"warning",message:t.msg}),this.$emit("edit-hobby")})}}},at=st,it=(s("d557"),Object(p["a"])(at,W,X,!1,null,"fa31c860",null)),ot=it.exports,nt={name:"hobby",data(){return{count:{onShelf:0,notOnShelf:0},page:1,pageSize:20,hobbyList:[],addHobbyVisible:!1,hobbyInfo:{name:"",description:"",point:"",count:"",expire:"",max:"",virtual:0},uploadImages:[]}},components:{HButton:T["a"],HInput:N["a"],HRadio:Q["a"],HRadioGroup:Q["b"],HobbyDisplay:ot},computed:{...Object(o["d"])({user:t=>t.users.userInfo}),filterList(){return[{text:"在架",value:0,count:this.count.onShelf},{text:"未上架",value:1,count:this.count.notOnShelf}]},type(){return Number(this.$route.query.type)||0},params(){return{page:this.page,pageSize:this.pageSize,status:this.type}},total(){switch(this.type){case 0:return this.count.onShelf;case 1:return this.count.notOnShelf}return 0}},methods:{isSelected(t){return t===this.type},showAddHobby(){this.addHobbyVisible=!0},resetInfo(){this.hobbyInfo={name:"",description:"",point:"",count:"",expire:"",max:"",virtual:0},this.uploadImages=[]},commitAddHobby(){this.hobbyInfo.name?Number(this.hobbyInfo.point)?u["a"].post(Z["a"].hobbyCreate,Object.assign({},this.hobbyInfo,{point:Number(this.hobbyInfo.point),count:Number(this.hobbyInfo.count)||0,max:Number(this.hobbyInfo.max)||0,pictures:this.uploadImages})).then(t=>{0===t.code?(this.$message({type:"success",message:"添加成功"}),this.getHobbyList(),this.addHobbyVisible=!1):this.$message({type:"warning",message:t.msg})}):this.$message({type:"warning",message:"请录入兑换周边所需积分"}):this.$message({type:"warning",message:"请录入周边名称"})},async uploadImage(t){const e=await u["a"].get(Y["a"].upload);if(0!==e.code)return;const{auth:s,token:a}=e;try{const e=await tt["a"].uploadMultiFiles(Array.from(t.target.files),a,this.user.uid,s,(t,e)=>{this.$showProcess({title:"图片上传中...",value:t,max:e})},!1),i=e.map(t=>t.thumbnail);this.uploadImages.push(...i)}catch(t){console.log(t)}},getHobbyList(){u["a"].get(Z["a"].hobbyList,{params:this.params}).then(t=>{0===t.code&&(this.count.onShelf=t.onShelfTotal,this.count.notOnShelf=t.notOnShelfTotal,this.hobbyList=t.list)})},refresh(){this.page=1,this.hobbyList=[],this.getHobbyList()},moveUp(t){const e=this.uploadImages[t-1];this.uploadImages[t-1]=this.uploadImages[t],this.uploadImages[t]=e,this.uploadImages.splice(0,0)},moveDown(t){const e=this.uploadImages[t+1];this.uploadImages[t+1]=this.uploadImages[t],this.uploadImages[t]=e,this.uploadImages.splice(0,0)},deleteUploadImage(t){this.uploadImages.splice(t,1)},deleteHobby(t){u["a"].post(Z["a"].hobbyDelete,{id:t}).then(t=>{0===t.code?this.$message({type:"success",message:t.msg}):this.$message({type:"warning",message:t.msg}),this.getHobbyList()})},setOnHobby(t){u["a"].post(Z["a"].hobbyOn,{id:t}).then(t=>{0===t.code?this.$message({type:"success",message:t.msg}):this.$message({type:"warning",message:t.msg}),this.getHobbyList()})},setDownHobby(t){u["a"].post(Z["a"].hobbyDown,{id:t}).then(t=>{0===t.code?this.$message({type:"success",message:t.msg}):this.$message({type:"warning",message:t.msg}),this.getHobbyList()})},handleCurrentChange(){this.getHobbyList()},editHobby(){this.getHobbyList()}},mounted(){this.getHobbyList()}},rt=nt,lt=(s("f813"),Object(p["a"])(rt,F,J,!1,null,"e95bcb52",null)),ct=lt.exports,ut=function(){var t=this,e=t._self._c;return e("div",{staticClass:"exchange"},[e("div",{staticClass:"header"},[e("div",{staticClass:"order-nav--wrapper"},t._l(t.orderNav,(function(s){return e("router-link",{key:s.status,class:{"nav-item":!0,selected:t.isSelected(s.status)},attrs:{replace:"",to:`${t.$route.path}?status=${s.status}${t.$route.hash}`}},[t._v(" "+t._s(s.text)+" "),s.count?e("span",[t._v("("+t._s(s.count)+")")]):t._e()])})),1)]),e("div",{staticClass:"orders"},[e("div",{staticClass:"multi-operations"},[0===t.status?e("h-button",{attrs:{disabled:!t.orders.length,size:"small"},on:{click:function(e){return t.checkMulti(1)}}},[t._v("批量同意")]):t._e(),0===t.status?e("h-button",{staticStyle:{"margin-left":"20px","margin-right":"40px"},attrs:{disabled:!t.orders.length,size:"small"},on:{click:function(e){return t.checkMulti(3)}}},[t._v("批量拒绝")]):t._e(),e("h-button",{attrs:{disabled:!t.currentTotal,size:"small"},on:{click:t.exportExcel}},[t._v("导出")])],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.orderList,stripe:""},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-descriptions",{attrs:{title:"收件信息",column:2,border:""}},[e("el-descriptions-item",[e("template",{slot:"label"},[e("i",{staticClass:"el-icon-user"}),t._v(" 收件人 ")]),t._v(" "+t._s(s.row.contact.receiver)+" ")],2),e("el-descriptions-item",[e("template",{slot:"label"},[e("i",{staticClass:"el-icon-mobile-phone"}),t._v(" 联系电话 ")]),t._v(" "+t._s(s.row.contact.tel)+" ")],2),e("el-descriptions-item",[e("template",{slot:"label"},[e("i",{staticClass:"el-icon-s-claim"}),t._v(" 淘宝账号 ")]),t._v(" "+t._s(s.row.contact.tb_account)+" ")],2),e("el-descriptions-item",[e("template",{slot:"label"},[e("i",{staticClass:"el-icon-office-building"}),t._v(" 收件地址 ")]),t._v(" "+t._s(s.row.contact.addr)+" ")],2),e("el-descriptions-item",[e("template",{slot:"label"},[e("i",{staticClass:"hanser icon-huifu"}),t._v(" 留言 ")]),t._v(" "+t._s(s.row.note)+" ")],2)],1),e("div",{staticClass:"order-code"},[t._v("订单号: "+t._s(s.row.order))]),e("div",{staticClass:"support"},[e("p",{staticClass:"support-label"},[t._v("出分人:")]),t._l(s.row.support,(function(s){return e("div",{key:s.bindUser+s.user.uid,staticClass:"support-user"},[e("a",{staticClass:"user",attrs:{href:"/space/"+s.user.uid,target:"_blank"}},[t._v(t._s(s.user.nickname))]),t._v("("+t._s("main"===s.role?"首付":"借出")+") "),e("span",{staticClass:"point"},[t._v(t._s(s.spend))]),e("span",{staticStyle:{"margin-left":"20px"}},[t._v("绑定账号: "),e("span",{class:s.platform},[t._v(t._s(s.bindUser))])])])}))],2)]}}])}),e("el-table-column",{attrs:{type:"index"}}),0===t.status?e("el-table-column",{attrs:{type:"selection"}}):t._e(),e("el-table-column",{attrs:{width:"250",label:"兑换周边或服务"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("order-hobby",{attrs:{hobby:t.row.hobby}})]}}])}),e("el-table-column",{attrs:{label:"用户"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{staticClass:"user",attrs:{href:t.getMainUserLink(s.row.support),target:"_blank"}},[t._v(t._s(t.getMainUserName(s.row.support)))])]}}])}),e("el-table-column",{attrs:{prop:"count",label:"数量",width:"50"}}),e("el-table-column",{attrs:{width:"180",label:"时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.updateTime||e.row.time)+" ")]}}])}),e("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(s){return[0===s.row.status?e("div",{staticClass:"operations check"},[e("h-button",{attrs:{size:"small",debonus:100},on:{click:function(e){return t.checkOrder(s.row.order,1)}}},[t._v("通过")]),e("h-button",{staticStyle:{"margin-left":"10px"},attrs:{debonus:100,type:"danger",size:"small"},on:{click:function(e){return t.checkOrder(s.row.order,3)}}},[t._v("拒绝")])],1):t._e(),1===s.row.status?e("div",{staticClass:"operations"},[e("h-button",{attrs:{size:"small",debonus:100},on:{click:function(e){return t.showDeliverOrder(s.row)}}},[t._v("发货")])],1):t._e(),2===s.row.status?e("div",{staticClass:"operations"},[e("span",{staticClass:"done"},[t._v("已发货")])]):t._e(),3===s.row.status?e("div",{staticClass:"operations"},[e("span",{staticClass:"rejected"},[t._v("已拒绝")])]):t._e(),4===s.row.status?e("div",{staticClass:"operations"},[e("span",{staticClass:"done"},[t._v("已完成")])]):t._e()]}}])})],1)],1),e("el-dialog",{attrs:{title:t.title,visible:t.showDeliver,"append-to-body":!0},on:{"update:visible":function(e){t.showDeliver=e},closed:t.resetDeliver}},[t.isVirtual?[e("div",{staticClass:"deliver-item"},[e("div",{staticClass:"deliver-label"},[t._v("推送链接:")]),e("h-input",{staticClass:"input",model:{value:t.deliver.transport,callback:function(e){t.$set(t.deliver,"transport",e)},expression:"deliver.transport"}})],1)]:[e("div",{staticClass:"deliver-item"},[e("div",{staticClass:"deliver-label"},[t._v("快递厂商:")]),e("h-input",{staticClass:"input",model:{value:t.deliver.deliver,callback:function(e){t.$set(t.deliver,"deliver",e)},expression:"deliver.deliver"}})],1),e("div",{staticClass:"deliver-item"},[e("div",{staticClass:"deliver-label"},[t._v("快递单号:")]),e("h-input",{staticClass:"input",model:{value:t.deliver.transport,callback:function(e){t.$set(t.deliver,"transport",e)},expression:"deliver.transport"}})],1)],e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("h-button",{attrs:{size:"small",plain:""},on:{click:function(e){t.showDeliver=!1}}},[t._v("取 消")]),e("h-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small"},on:{click:t.deliverOrder}},[t._v("确 定")])],1)],2)],1)},ht=[],dt=s("f8b7"),bt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-hobby"},[e("div",{staticClass:"info"},[e("div",{staticClass:"cover"},[e("el-image",{staticClass:"order-img",attrs:{src:t.cover,width:"80",height:"80",alt:t.hobby.name,"preview-src-list":t.pictures}})],1),e("div",{staticClass:"hobby-info"},[e("a",{staticClass:"hobby-name",attrs:{href:t.hobbyLink,target:"_blank"}},[t._v(t._s(t.hobby.name))])])])])},pt=[],mt={name:"order-hobby",props:["hobby"],computed:{hobbyLink(){return"/score-hobby/"+this.hobby.id},cover(){return this.hobby.pictures.length?this.hobby.pictures[0]:"https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg"},pictures(){return this.hobby.pictures.length?this.hobby.pictures:["https://cdn.2550505.com/share/legacy-sso/default-hobby.jpg"]},platformClass(){switch(this.hobby.platform){case 1:return"douyu";case 2:return"bilibili";case 3:return"community"}return"douyu"},platform(){switch(this.hobby.platform){case 1:return"斗鱼";case 2:return"B站";case 3:return"双平台"}return"斗鱼"}}},gt=mt,yt=(s("409b"),Object(p["a"])(gt,bt,pt,!1,null,"36dad9ce",null)),ft=yt.exports,vt={name:"exchange",data(){return{page:1,pageSize:10,orderList:[],total:0,total0:0,total1:0,total2:0,total3:0,total4:0,loadDone:!1,loading:!1,showDeliver:!1,orders:[],deliver:{order:"",deliver:"",transport:""},selectedOrder:null}},components:{OrderHobby:ft,HButton:T["a"],HInput:N["a"]},computed:{...Object(o["d"])({isMobile:t=>t.media.isMobile}),status(){const t=Number(this.$route.query.status);return[0,1,2,3,4,5,-1].includes(t)?t:0},orderNav(){return[{status:0,text:"待审核",count:this.total0},{status:1,text:"待发货",count:this.total1},{status:2,text:"已发货",count:this.total2},{status:3,text:"已拒绝",count:this.total3},{status:4,text:"已完成",count:this.total4},{status:-1,text:"全部订单",count:this.total}]},currentTotal(){switch(this.status){case 0:return this.total0;case 1:return this.total1;case 2:return this.total2;case 3:return this.total3;case 4:return this.total4}return this.total},isVirtual(){var t;return null===(t=this.selectedOrder)||void 0===t?void 0:t.hobby.virtual},title(){return this.isVirtual?"填写链接":"快递订单"}},watch:{status(){this.reset(),this.getOrderList()}},methods:{resetDeliver(){this.deliver.order="",this.deliver.deliver="",this.deliver.transport=""},handleSelectionChange(t){this.orders=t.map(t=>t.order)},getMainUserLink(t){const e=t.find(t=>"main"===t.role);return"/space/"+e.user.uid},getMainUserName(t){const e=t.find(t=>"main"===t.role);return e.user.nickname},getOrderList(){this.loading=!0,u["a"].get(dt["a"].allOrder,{params:{page:this.page,pageSize:this.pageSize,status:this.status}}).then(t=>{0===t.code&&(this.total=t.total,this.total0=t.statusTotal[0],this.total1=t.statusTotal[1],this.total2=t.statusTotal[2],this.total3=t.statusTotal[3],this.total4=t.statusTotal[4],this.orderList.push(...t.list),t.list.length<this.pageSize&&(this.loadDone=!0)),this.loading=!1})},getMoreOrderList(){this.getOrderList(),this.page++},isSelected(t){const e=Number(t);return this.orderNav.find(t=>t.status===this.status)?e===this.status:0===t},reset(){this.page=1,this.orderList=[]},checkOrder(t,e){1===e?this.$confirm("确认审核","订单审核",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{u["a"].post(dt["a"].checkOrder,{order:t,status:e}).then(e=>{if(0===e.code){this.$message({type:"success",message:e.msg});const s=this.orderList.findIndex(e=>e.order===t);-1!==this.status?(this.orderList.splice(s,1),this["total"+this.status]--):(this.reset(),this.getOrderList())}else this.$message({type:"warning",message:e.msg})})}).catch(()=>{this.$message({type:"success",message:"已取消审核~"})}):3===e&&this.$prompt("请输入原因","拒绝订单",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"若不输入拒绝理由，系统将默认原因为：库存不足"}).then(({value:s})=>{u["a"].post(dt["a"].checkOrder,{order:t,status:e,reason:s}).then(s=>{if(0===s.code){this.$message({type:"success",message:s.msg});const a=this.orderList.findIndex(e=>e.order===t);-1!==this.status?(this.orderList.splice(a,1),this["total"+this.status]--,this["total"+e]++):(this.reset(),this.getOrderList())}else this.$message({type:"warning",message:s.msg})})}).catch(()=>{this.$message({type:"success",message:"取消输入"})})},checkMulti(t){1===t?this.$confirm("确认审核","订单审核",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{u["a"].post(dt["a"].checkMultiOrder,{orders:this.orders,status:t}).then(t=>{0===t.code?(this.$message({type:"success",message:t.msg}),this.reset(),this.getOrderList()):this.$message({type:"warning",message:t.msg})})}).catch(()=>{this.$message({type:"success",message:"已取消审核~"})}):3===t&&this.$prompt("请输入原因","拒绝订单",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"若不输入拒绝理由，系统将默认原因为：库存不足"}).then(({value:e})=>{u["a"].post(dt["a"].checkMultiOrder,{orders:this.orders,status:t,reason:e}).then(t=>{0===t.code?(this.$message({type:"success",message:t.msg}),this.reset(),this.getOrderList()):this.$message({type:"warning",message:t.msg})})}).catch(()=>{this.$message({type:"success",message:"取消输入"})})},showDeliverOrder(t){this.selectedOrder=t,this.showDeliver=!0,this.deliver.order=t.order},deliverOrder(){u["a"].post(dt["a"].deliverOrder,this.deliver).then(t=>{if(0===t.code){this.$message({type:"success",message:t.msg}),this.showDeliver=!1;const e=this.orderList.findIndex(t=>t.order===this.deliver.order);-1!==this.status?(this.orderList.splice(e,1),this["total"+this.status]--,this.total2++):(this.reset(),this.getOrderList())}else this.$message({type:"warning",message:t.msg})})},exportExcel(){this.currentTotal?window.open("/order/export?status="+this.status):this.$message({type:"warning",message:"当前没有可导出的数据"})}},mounted(){this.getOrderList()}},_t=vt,Ct=(s("df2c"),Object(p["a"])(_t,ut,ht,!1,null,"5553db92",null)),wt=Ct.exports,kt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contribution"},[e("div",{staticClass:"title"},[t._v("发放贡献度")]),e("div",{staticClass:"contribution-item"},[e("div",{staticClass:"label"},[t._v("用户UID:")]),e("div",{staticClass:"line"},[e("h-input",{staticClass:"input",attrs:{size:"medium",placeholder:"俱乐部UID"},model:{value:t.params.uid,callback:function(e){t.$set(t.params,"uid",e)},expression:"params.uid"}}),e("h-button",{staticClass:"user-search",attrs:{size:"small"},on:{click:t.searchUser}},[e("i",{staticClass:"hanser icon-sousuo1"})]),t.targetUser?e("notice-user",{attrs:{avatar:t.targetUser.avatar,size:50,auth:t.targetUser.auth,authentication:t.targetUser.authentication,nickname:t.targetUser.nickname,uid:t.targetUser.uid,iconSize:14,colors:t.level.color}}):t._e()],1),e("div",{staticClass:"label"},[t._v("发放额度:")]),e("div",{staticClass:"line"},[e("h-input",{staticClass:"input",attrs:{size:"medium",placeholder:"发放额度"},model:{value:t.params.contribution,callback:function(e){t.$set(t.params,"contribution",e)},expression:"params.contribution"}})],1),t._m(0),e("div",{staticClass:"templates"},t._l(t.templates,(function(s){return e("div",{key:s.id,staticClass:"template-item",on:{click:function(e){return t.setTemplate(s.text)}}},[t._v(" "+t._s(s.title)+" ")])})),0),e("div",{staticClass:"line"},[e("h-input",{staticClass:"template-input",attrs:{size:"medium",placeholder:"已为您的账号 [user] 发放 [contribution] 贡献"},model:{value:t.params.template,callback:function(e){t.$set(t.params,"template",e)},expression:"params.template"}})],1),t.renderHtml?e("div",{staticClass:"render",domProps:{innerHTML:t._s(t.renderHtml)}}):t._e(),e("div",{staticClass:"line"},[e("h-button",{staticClass:"preview-btn",attrs:{plain:""},on:{click:t.preview}},[t._v("预览")]),e("h-button",{staticClass:"submit-btn",on:{click:t.submit}},[t._v("提交")])],1)])])},xt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"label"},[t._v(" 模板(用 "),e("span",{staticClass:"keyword"},[t._v("[user]")]),t._v(" 代替用户, "),e("span",{staticClass:"keyword"},[t._v("[contribution]")]),t._v(" 代替发放额度): ")])}],It=(s("4e3e"),s("365c")),$t=s("4a51"),St=s("475f"),zt={name:"contribution",data(){return{params:{uid:"",contribution:"",template:""},targetUser:null,renderHtml:"",templates:[{id:1,title:"默认模版",text:"已为您的账号 [user] 发放 [contribution] 贡献"},{id:2,title:"反馈",text:"感谢反馈，已为您的账号 [user] 发放发放 [contribution] 贡献"},{id:3,title:"反馈BUG",text:"感谢反馈BUG，我们正在修复中，已为您的账号 [user] 发放发放 [contribution] 贡献"}]}},components:{HButton:T["a"],HInput:N["a"],NoticeUser:St["a"]},computed:{...Object(o["d"])({levels:t=>t.level.levels}),level(){if(this.targetUser){const{exp:t}=this.targetUser;let e=this.levels[0];return this.levels.forEach(s=>{s.exp<=t&&s.level>e.level&&(e=s)}),e}return{}}},methods:{searchUser(){this.params.uid?u["a"].get(It["a"].getUserInfo,{params:{uid:this.params.uid}}).then(t=>{t.code?this.$message({type:"warning",message:t.msg}):this.targetUser=t.info}):this.$message({type:"warning",message:"请输入用户UID"})},preview(){this.targetUser?this.params.contribution?this.params.template?this.renderHtml=this.params.template.replace(/\[user\]/g,`<a href="/space/${this.params.uid}" target="_blank" class="link">${this.targetUser.nickname}</a>`).replace(/\[contribution\]/g,`<span class="keyword">${Math.abs(this.params.contribution)}</span>`):this.$message({type:"warning",message:"请输入模版"}):this.$message({type:"warning",message:"请输入要发放的贡献度"}):this.$message({type:"warning",message:"请输入查找用户"})},submit(){u["a"].post($t["a"].deliverContribution,this.params).then(t=>{0===t.code?(this.$message({type:"success",message:t.msg}),this.params={uid:"",contribution:"",template:""},this.targetUser=null,this.renderHtml=""):this.$message({type:"warning",message:t.msg})})},setTemplate(t){this.params.template=t}}},Ut=zt,Lt=(s("5306"),Object(p["a"])(Ut,kt,xt,!1,null,"2d27ab9e",null)),At=Lt.exports,Ht={name:"manager",data(){return{}},components:{Point:V,Manager:G,Hobby:ct,Exchange:wt},computed:{...Object(o["d"])({user:t=>t.users.userInfo}),...Object(o["b"])("users",{isAdmin:"isAdmin",isHanser:"isHanser",isHobbyManager:"isHobbyManager",isScoreManager:"isScoreManager",isContributionManager:"isContributionManager"}),navList(){return[{text:"积分管理",hash:"#point",show:this.isScoreManager},{text:"贡献管理",hash:"#contribution",show:this.isHobbyManager},{text:"周边管理",hash:"#hobby",show:this.isContributionManager},{text:"兑换管理",hash:"#exchange",show:this.isHobbyManager},{text:"吧务管理",hash:"#manager",show:this.isAdmin}]},navItem(){const{hash:t}=this.$route;switch(t){case"#manager":return G;case"#point":return V;case"#contribution":return At;case"#hobby":return ct;case"#exchange":return wt}return V}},methods:{checkSelected(t){const e=this.$route.hash,s=this.navList.find(t=>t.hash===e&&t.show);return s?t===s.hash:t===this.navList[0].hash}}},Ot=Ht,Dt=(s("e943"),Object(p["a"])(Ot,a,i,!1,null,"cdc65434",null));e["default"]=Dt.exports},"25db":function(t,e,s){"use strict";s("fda5")},"3a3b":function(t,e,s){},"409b":function(t,e,s){"use strict";s("e69a")},4484:function(t,e,s){"use strict";s("9b29")},4654:function(t,e,s){},"475f":function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notice-user"},[e("link-avatar",{attrs:{avatar:t.avatar,size:t.size,auth:t.auth,authentication:t.authentication,nickname:t.nickname,uid:t.uid}}),e("div",{staticClass:"stack"},[e("div",{staticClass:"top"},[e("level-nickname",{attrs:{nickname:t.nickname,uid:t.uid,colors:t.colors}}),t._t("label")],2),e("div",{staticClass:"bottom"},[t._t("bottom")],2)])],1)},i=[],o=s("c362"),n=s("e51f"),r={name:"notice-user",props:["avatar","size","auth","authentication","nickname","uid","colors"],components:{LinkAvatar:o["a"],LevelNickname:n["a"]}},l=r,c=(s("4484"),s("2877")),u=Object(c["a"])(l,a,i,!1,null,"312eb0cc",null);e["a"]=u.exports},"4a51":function(t,e,s){"use strict";e["a"]={exchangeList:"/contribution/exchange-list",exchange:"/contribution/exchange",record:"/contribution/record",deliverContribution:"/contribution/deliver-contribution"}},5306:function(t,e,s){"use strict";s("8cd5")},"5e6e":function(t,e,s){},"5ee2":function(t,e,s){"use strict";e["a"]={hobbyCreate:"/hobby/create",hobbyList:"/hobby/list",hobbyDelete:"/hobby/delete",hobbyOn:"/hobby/set-on",hobbyDown:"/hobby/set-down",hobbyEdit:"/hobby/edit",userHobbyList:"/hobby/score/list",hobby:"/hobby/",hobbyComment:"/hobby/comment/",hobbyComments:"/hobby/comments",hobbyCommentDelete:"/hobby/comment/delete/",hobbyCanExchange:"/hobby/can-exchange",exchangeHobby:"/hobby/exchange",borrowExchange:"/hobby/borrow-exchange"}},"6f50":function(t,e,s){"use strict";s("5e6e")},8607:function(t,e,s){"use strict";s("08dd")},"8cd5":function(t,e,s){},"8d4a":function(t,e,s){},"9b29":function(t,e,s){},a388:function(t,e,s){"use strict";s("3a3b")},d557:function(t,e,s){"use strict";s("8d4a")},df2c:function(t,e,s){"use strict";s("e987")},e69a:function(t,e,s){},e943:function(t,e,s){"use strict";s("ecb5")},e987:function(t,e,s){},ecb5:function(t,e,s){},edf1:function(t,e,s){},f20b:function(t,e,s){},f56c:function(t,e,s){"use strict";s("4654")},f813:function(t,e,s){"use strict";s("edf1")},f8b7:function(t,e,s){"use strict";e["a"]={orderList:"/order/list",allOrder:"/order/all/list",checkOrder:"/order/check",deliverOrder:"/order/deliver",checkMultiOrder:"/order/check/multi",borrowList:"/order/borrow/list",checkBorrow:"/user/check/borrow"}},fda5:function(t,e,s){}}]);