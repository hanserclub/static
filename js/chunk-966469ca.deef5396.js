(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-966469ca"],{"04b6":function(t,e,i){"use strict";i("a55c")},"08a9":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"viewer-fade"}},[e("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper",style:{"z-index":t.viewerZIndex},attrs:{tabindex:"-1"}},[e("div",{staticClass:"el-image-viewer__mask",on:{click:function(e){return e.target!==e.currentTarget?null:t.handleMaskClick.apply(null,arguments)}}}),e("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:t.hide}},[e("i",{staticClass:"el-icon-close"})]),t.isSingle?t._e():[e("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!t.infinite&&t.isFirst},on:{click:t.prev}},[e("i",{staticClass:"el-icon-arrow-left"})]),e("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!t.infinite&&t.isLast},on:{click:t.next}},[e("i",{staticClass:"el-icon-arrow-right"})])],e("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[e("div",{staticClass:"el-image-viewer__actions__inner"},[e("i",{staticClass:"el-icon-zoom-out",on:{click:function(e){return t.handleActions("zoomOut")}}}),e("i",{staticClass:"el-icon-zoom-in",on:{click:function(e){return t.handleActions("zoomIn")}}}),e("i",{staticClass:"el-image-viewer__actions__divider"}),e("i",{class:t.mode.icon,on:{click:t.toggleMode}}),e("i",{staticClass:"el-image-viewer__actions__divider"}),e("i",{staticClass:"el-icon-refresh-left",on:{click:function(e){return t.handleActions("anticlocelise")}}}),e("i",{staticClass:"el-icon-refresh-right",on:{click:function(e){return t.handleActions("clocelise")}}})])]),e("div",{staticClass:"el-image-viewer__canvas"},t._l(t.urlList,(function(i,s){return s===t.index?e("img",{key:i,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img",style:t.imgStyle,attrs:{src:t.currentImg},on:{load:t.handleImgLoad,error:t.handleImgError,mousedown:t.handleMouseDown}}):t._e()})),0)],2)])},a=[],o=i("a026");const n=o["default"].prototype.$isServer,l=/([\:\-\_]+(.))/g,r=/^moz([A-Z])/,c=n?0:Number(document.documentMode),d=function(t){return(t||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")},u=function(t){return t.replace(l,(function(t,e,i,s){return s?i.toUpperCase():i})).replace(r,"Moz$1")},v=function(){return!n&&document.addEventListener?function(t,e,i){t&&e&&i&&t.addEventListener(e,i,!1)}:function(t,e,i){t&&e&&i&&t.attachEvent("on"+e,i)}}(),h=function(){return!n&&document.removeEventListener?function(t,e,i){t&&e&&t.removeEventListener(e,i,!1)}:function(t,e,i){t&&e&&t.detachEvent("on"+e,i)}}();function p(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function m(t,e){if(t){for(var i=t.className,s=(e||"").split(" "),a=0,o=s.length;a<o;a++){var n=s[a];n&&(t.classList?t.classList.add(n):p(t,n)||(i+=" "+n))}t.classList||t.setAttribute("class",i)}}function f(t,e){if(t&&e){for(var i=e.split(" "),s=" "+t.className+" ",a=0,o=i.length;a<o;a++){var n=i[a];n&&(t.classList?t.classList.remove(n):p(t,n)&&(s=s.replace(" "+n+" "," ")))}t.classList||t.setAttribute("class",d(s))}}const g=c<9?function(t,e){if(!n){if(!t||!e)return null;e=u(e),"float"===e&&(e="styleFloat");try{switch(e){case"opacity":try{return t.filters.item("alpha").opacity/100}catch(i){return 1}default:return t.style[e]||t.currentStyle?t.currentStyle[e]:null}}catch(i){return t.style[e]}}}:function(t,e){if(!n){if(!t||!e)return null;e=u(e),"float"===e&&(e="cssFloat");try{var i=document.defaultView.getComputedStyle(t,"");return t.style[e]||i?i[e]:null}catch(s){return t.style[e]}}};let y=t=>{var e={};return t&&"[object Function]"===e.toString.call(t)};"object"===typeof Int8Array||!o["default"].prototype.$isServer&&"function"===typeof document.childNodes||(y=function(t){return"function"===typeof t||!1});Object.prototype.hasOwnProperty;const k=function(){return!o["default"].prototype.$isServer&&!!window.navigator.userAgent.match(/firefox/i)};function x(t){let e=!1;return function(...i){e||(e=!0,window.requestAnimationFrame(s=>{t.apply(this,i),e=!1}))}}var C=function(t){for(let e=1,i=arguments.length;e<i;e++){let i=arguments[e]||{};for(let e in i)if(i.hasOwnProperty(e)){let s=i[e];void 0!==s&&(t[e]=s)}}return t};let w,b=!1,_=!1;const I=function(){if(o["default"].prototype.$isServer)return;let t=V.modalDom;return t?b=!0:(b=!1,t=document.createElement("div"),V.modalDom=t,t.addEventListener("touchmove",(function(t){t.preventDefault(),t.stopPropagation()})),t.addEventListener("click",(function(){V.doOnModalClick&&V.doOnModalClick()}))),t},S={},V={modalFade:!0,getInstance:function(t){return S[t]},register:function(t,e){t&&e&&(S[t]=e)},deregister:function(t){t&&(S[t]=null,delete S[t])},nextZIndex:function(){return V.zIndex++},modalStack:[],doOnModalClick:function(){const t=V.modalStack[V.modalStack.length-1];if(!t)return;const e=V.getInstance(t.id);e&&e.closeOnClickModal&&e.close()},openModal:function(t,e,i,s,a){if(o["default"].prototype.$isServer)return;if(!t||void 0===e)return;this.modalFade=a;const n=this.modalStack;for(let o=0,r=n.length;o<r;o++){const e=n[o];if(e.id===t)return}const l=I();if(m(l,"v-modal"),this.modalFade&&!b&&m(l,"v-modal-enter"),s){let t=s.trim().split(/\s+/);t.forEach(t=>m(l,t))}setTimeout(()=>{f(l,"v-modal-enter")},200),i&&i.parentNode&&11!==i.parentNode.nodeType?i.parentNode.appendChild(l):document.body.appendChild(l),e&&(l.style.zIndex=e),l.tabIndex=0,l.style.display="",this.modalStack.push({id:t,zIndex:e,modalClass:s})},closeModal:function(t){const e=this.modalStack,i=I();if(e.length>0){const s=e[e.length-1];if(s.id===t){if(s.modalClass){let t=s.modalClass.trim().split(/\s+/);t.forEach(t=>f(i,t))}e.pop(),e.length>0&&(i.style.zIndex=e[e.length-1].zIndex)}else for(let i=e.length-1;i>=0;i--)if(e[i].id===t){e.splice(i,1);break}}0===e.length&&(this.modalFade&&m(i,"v-modal-leave"),setTimeout(()=>{0===e.length&&(i.parentNode&&i.parentNode.removeChild(i),i.style.display="none",V.modalDom=void 0),f(i,"v-modal-leave")},200))}};Object.defineProperty(V,"zIndex",{configurable:!0,get(){return _||(w=w||(o["default"].prototype.$ELEMENT||{}).zIndex||2e3,_=!0),w},set(t){w=t}});const O=function(){if(!o["default"].prototype.$isServer&&V.modalStack.length>0){const t=V.modalStack[V.modalStack.length-1];if(!t)return;const e=V.getInstance(t.id);return e}};o["default"].prototype.$isServer||window.addEventListener("keydown",(function(t){if(27===t.keyCode){const t=O();t&&t.closeOnPressEscape&&(t.handleClose?t.handleClose():t.handleAction?t.handleAction("cancel"):t.close())}}));var L=V;let P;var $=function(){if(o["default"].prototype.$isServer)return 0;if(void 0!==P)return P;const t=document.createElement("div");t.className="el-scrollbar__wrap",t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const e=t.offsetWidth;t.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",t.appendChild(i);const s=i.offsetWidth;return t.parentNode.removeChild(t),P=e-s,P};let z,H=1;Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean;const E={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},M=k()?"DOMMouseScroll":"mousewheel";var T={name:"elImageViewer",props:{urlList:{type:Array,default:()=>[]},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:()=>{}},onClose:{type:Function,default:()=>{}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0}},data(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:E.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}},computed:{isSingle(){return this.urlList.length<=1},isFirst(){return 0===this.index},isLast(){return this.index===this.urlList.length-1},currentImg(){return this.urlList[this.index]},imgStyle(){const{scale:t,deg:e,offsetX:i,offsetY:s,enableTransition:a}=this.transform,o={transform:`scale(${t}) rotate(${e}deg)`,transition:a?"transform .3s":"","margin-left":i+"px","margin-top":s+"px"};return this.mode===E.CONTAIN&&(o.maxWidth=o.maxHeight="100%"),o},viewerZIndex(){const t=L.nextZIndex();return this.zIndex>t?this.zIndex:t}},watch:{index:{handler:function(t){this.reset(),this.onSwitch(t)}},currentImg(t){this.$nextTick(t=>{const e=this.$refs.img[0];e.complete||(this.loading=!0)})}},methods:{hide(){this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall(){this._keyDownHandler=t=>{t.stopPropagation();const e=t.keyCode;switch(e){case 27:this.hide();break;case 32:this.toggleMode();break;case 37:this.prev();break;case 38:this.handleActions("zoomIn");break;case 39:this.next();break;case 40:this.handleActions("zoomOut");break}},this._mouseWheelHandler=x(t=>{const e=t.wheelDelta?t.wheelDelta:-t.detail;e>0?this.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):this.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})}),v(document,"keydown",this._keyDownHandler),v(document,M,this._mouseWheelHandler)},deviceSupportUninstall(){h(document,"keydown",this._keyDownHandler),h(document,M,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad(t){this.loading=!1},handleImgError(t){this.loading=!1,t.target.alt="加载失败"},handleMouseDown(t){if(this.loading||0!==t.button)return;const{offsetX:e,offsetY:i}=this.transform,s=t.pageX,a=t.pageY;this._dragHandler=x(t=>{this.transform.offsetX=e+t.pageX-s,this.transform.offsetY=i+t.pageY-a}),v(document,"mousemove",this._dragHandler),v(document,"mouseup",t=>{h(document,"mousemove",this._dragHandler)}),t.preventDefault()},handleMaskClick(){this.maskClosable&&this.hide()},reset(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode(){if(this.loading)return;const t=Object.keys(E),e=Object.values(E),i=e.indexOf(this.mode),s=(i+1)%t.length;this.mode=E[t[s]],this.reset()},prev(){if(this.isFirst&&!this.infinite)return;const t=this.urlList.length;this.index=(this.index-1+t)%t},next(){if(this.isLast&&!this.infinite)return;const t=this.urlList.length;this.index=(this.index+1)%t},handleActions(t,e={}){if(this.loading)return;const{zoomRate:i,rotateDeg:s,enableTransition:a}={zoomRate:.2,rotateDeg:90,enableTransition:!0,...e},{transform:o}=this;switch(t){case"zoomOut":o.scale>.2&&(o.scale=parseFloat((o.scale-i).toFixed(3)));break;case"zoomIn":o.scale=parseFloat((o.scale+i).toFixed(3));break;case"clocelise":o.deg+=s;break;case"anticlocelise":o.deg-=s;break}o.enableTransition=a}},mounted(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["el-image-viewer__wrapper"].focus()},destroyed(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},F=T,N=i("2877"),B=Object(N["a"])(F,s,a,!1,null,null,null);e["a"]=B.exports},"13d5":function(t,e,i){"use strict";var s=i("23e7"),a=i("d58f").left,o=i("a640"),n=i("2d00"),l=i("605d"),r=o("reduce"),c=!l&&n>79&&n<83;s({target:"Array",proto:!0,forced:!r||c},{reduce:function(t){var e=arguments.length;return a(this,t,e,e>1?arguments[1]:void 0)}})},"234f":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-skeleton"},[e("el-skeleton",{attrs:{animated:""}},[e("template",{slot:"template"},[e("div",{staticClass:"sk-title"},[e("el-skeleton-item",{staticStyle:{width:"20%"},attrs:{variant:"text"}})],1),e("div",{staticClass:"sk-divider"}),e("div",{staticClass:"sk-body"},[e("div",{staticClass:"sk-body__aside"},[e("el-skeleton-item",{staticStyle:{width:"50px",height:"50px"},attrs:{variant:"image"}})],1),e("div",{staticClass:"sk-body__main"},[e("div",{staticClass:"sk-info"},[e("el-skeleton-item",{staticStyle:{width:"64px"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"80px",margin:"0 5px"},attrs:{variant:"text"}})],1),e("el-skeleton-item",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"100%",margin:"5px 0"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"100%",margin:"5px 0"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"100%",margin:"5px 0"},attrs:{variant:"text"}})],1)])])],2)],1)},a=[],o={name:"content-skeleton"},n=o,l=(i("04b6"),i("2877")),r=Object(l["a"])(n,s,a,!1,null,"52302b5d",null);e["a"]=r.exports},"56e0":function(t,e,i){},"605d":function(t,e,i){var s=i("c6b6"),a=i("da84");t.exports="process"==s(a.process)},"7ce7":function(t,e,i){"use strict";i("56e0")},a55c:function(t,e,i){},a640:function(t,e,i){"use strict";var s=i("d039");t.exports=function(t,e){var i=[][t];return!!i&&s((function(){i.call(null,e||function(){return 1},1)}))}},b17c:function(t,e,i){},b2ad:function(t,e,i){"use strict";i("f39e")},b4eb:function(t,e,i){"use strict";i("b17c")},b717:function(t,e,i){},cbff:function(t,e,i){"use strict";var s=function(){var t,e=this,i=e._self._c;return i("div",{staticClass:"vote-panel"},[e.voteCollapse?i("div",[e.hideToggleButton?e._e():i("div",{staticClass:"vote-expand-button",attrs:{size:"mini"},on:{click:e.handleVoteExpand}},[i("i",{staticClass:"fa-solid fa-square-poll-vertical vote-button-icon"}),e._v(" 查看投票 ")])]):i("div",[!0===e.loading?i("div",[1===(null===(t=e.vote)||void 0===t?void 0:t.type)?i("vote-skeleton-image"):i("vote-skeleton-text")],1):i("div",{class:{"vote-container":!0,"vote-progressing":!e.voteHasExpired}},[e.hideToggleButton?e._e():i("div",{staticClass:"vote-collapse-button",attrs:{size:"mini"},on:{click:e.handleVoteCollapse}},[i("i",{staticClass:"fa-solid fa-square-poll-vertical vote-button-icon"}),e._v("收起投票 ")]),i("div",{staticClass:"vote-header"},[i("div",{staticClass:"vote-title"},[i("i",{staticClass:"fa-solid fa-square-poll-vertical vote-button-icon"}),e._v(" "+e._s(e.vote.title)+" ")]),i("div",{staticClass:"vote-info"},[i("div",{staticClass:"vote-person-count"},[e._v(" 参与人数："),i("span",[e._v(e._s(e.total))]),e._v("人 ")]),e.votePeopleButtonVisible?i("div",{staticClass:"vote-see-people",attrs:{size:"mini"},on:{click:e.handleSeeVotePeople}},[e._v(" 查看投票人 ")]):e._e()])]),i("div",{staticClass:"vote-footer"},[i("div",{staticClass:"vote-footer-row"},[i("div",{staticClass:"vote-footer-item vote-check-type"},[e._v(" 投票类型："+e._s(0===e.vote.checkType?"单选":`多选 最多选${e.vote.max}项`)+" ")]),i("div",{staticClass:"vote-footer-item"},[e._v(" "+e._s(e.voteTimeStatus)+" ")])])]),i("div",{staticClass:"vote-content"},[0===e.vote.type?i("div",{staticClass:"vote-item-list-text"},e._l(e.options,(function(t,s){return i("div",{key:t.id,class:{"vote-item":!0,"vote-item-not-voted":!e.currentUserHasVoted,"vote-item-voted":e.selectedOptionIdList.includes(t.id)},on:{click:function(i){!e.voteHasExpired&&!e.currentUserHasVoted&&e.handleOptionClick(t)}}},[e.currentUserHasVoted||e.voteHasExpired?i("div",{staticClass:"vote-item-bg",style:{width:e.calculateVotePercentage(t.num),"border-top-right-radius":"100%"===e.calculateVotePercentage(t.num)?"8px":"0","border-bottom-right-radius":"100%"===e.calculateVotePercentage(t.num)?"8px":"0"}}):e._e(),i("div",{staticClass:"vote-item-content"},[i("div",{staticClass:"vote-item-index"},[e._v(e._s(s+1)+".")]),i("div",{staticClass:"vote-item-title",attrs:{title:t.text}},[e._v(" "+e._s(t.text)+" ")]),i("div",{staticClass:"vote-item-status"},[i("span",{staticClass:"vote-item-selected"},[e._v(" "+e._s(e.currentUserHasVoted&&null!==t&&void 0!==t&&t.voted?"✅":"")+" "+e._s(!e.currentUserHasVoted&&e.selectedOptionIdList.includes(t.id)?"✅":"")+" ")]),e.currentUserHasVoted||e.voteHasExpired?i("span",{staticClass:"vote-item-count"},[e._v(" "+e._s(t.num)+"票 ")]):e._e()])])])})),0):i("div",{staticClass:"vote-item-list-image"},e._l(e.options,(function(t,s){return i("el-card",{key:t.id,class:{"vote-item":!0,"vote-item-not-voted":!e.currentUserHasVoted,"vote-item-voted":e.selectedOptionIdList.includes(t.id),"vote-item-highlight":!e.currentUserHasVoted&&e.cardBorderVisible},attrs:{"body-style":{padding:"0px",height:"100%",position:"relative"}},nativeOn:{click:function(i){!e.voteHasExpired&&!e.currentUserHasVoted&&e.handleOptionClick(t)},mouseover:function(t){return e.handleCardMouseOver.apply(null,arguments)},mouseleave:function(t){return e.handleCardMouseLeave.apply(null,arguments)}}},[i("el-image",{key:t.image,staticClass:"image vote-item-image",attrs:{slot:"header",lazy:"",fit:"cover",src:t.image},on:{click:function(i){return i.stopPropagation(),e.handlePreview(t.image)}},nativeOn:{mouseover:function(t){return t.stopPropagation(),e.handleImageMouseOver.apply(null,arguments)},mouseleave:function(t){return t.stopPropagation(),e.handleImageMouseLeave.apply(null,arguments)}},slot:"header"},[i("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[i("img",{attrs:{width:"120",height:"120",alt:"loading",src:"https://cdn.2550505.com/share/legacy-sso/loading.jpg"}})]),i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("img",{attrs:{width:"120",height:"120",alt:"failed",src:"https://cdn.2550505.com/share/legacy-sso/fail.jpg"}})])]),e.currentUserHasVoted||e.voteHasExpired?i("div",{staticClass:"vote-item-bg",style:{width:e.calculateVotePercentage(t.num),"border-top-right-radius":"100%"===e.calculateVotePercentage(t.num)?"8px":"0","border-bottom-right-radius":"100%"===e.calculateVotePercentage(t.num)?"8px":"0"}}):e._e(),i("div",{staticClass:"vote-item-body"},[i("div",{staticClass:"vote-item-index"},[e._v(e._s(s+1)+".")]),i("div",{staticClass:"vote-item-title",attrs:{title:t.text}},[e._v(" "+e._s(t.text)+" ")]),i("div",{staticClass:"vote-item-status"},[i("span",{staticClass:"vote-item-selected"},[e._v(" "+e._s(e.currentUserHasVoted&&null!==t&&void 0!==t&&t.voted?"✅":"")+" "+e._s(!e.currentUserHasVoted&&e.selectedOptionIdList.includes(t.id)?"✅":"")+" ")]),e.currentUserHasVoted||e.voteHasExpired?i("span",{staticClass:"vote-item-count"},[e._v(" "+e._s(t.num)+"票 ")]):e._e()])])],1)})),1),i("div",{staticClass:"vote-commit-button-container"},[e.currentUserHasVoted||e.voteHasExpired?e._e():i("h-button",{staticClass:"vote-commit-button",attrs:{size:"mini",disabled:0===e.selectedOptionIdList.length},on:{click:e.handleVoteConfirm}},[e._v("投票")])],1)]),i("el-dialog",{attrs:{width:"720px",visible:e.modelVisible,title:"参与投票的人","append-to-body":!0,fullscreen:e.isMobile},on:{"update:visible":function(t){e.modelVisible=t}}},[i("vote-people",{attrs:{voteId:e.voteId}})],1)],1),e.showViewer?i("el-image-viewer",{attrs:{"url-list":e.primaryPictures,"on-close":e.handlePreviewClose}}):e._e()],1)])},a=[],o=(i("13d5"),i("14d9"),i("db04")),n=i("00b6"),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vote-skeleton"},[e("el-skeleton",{attrs:{animated:""}},[e("template",{slot:"template"},[e("div",{staticClass:"skeleton-row"},[e("el-skeleton-item",{staticClass:"skeleton-text",staticStyle:{width:"50%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticClass:"skeleton-text",staticStyle:{width:"20%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticClass:"skeleton-text",staticStyle:{width:"30%"},attrs:{variant:"text"}})],1),e("div",{staticClass:"skeleton-row"},[e("el-skeleton-item",{staticClass:"skeleton-text",staticStyle:{width:"100%"},attrs:{variant:"text"}})],1),e("div",{staticClass:"skeleton-row"},[e("el-skeleton-item",{staticClass:"skeleton-text",staticStyle:{width:"100%"},attrs:{variant:"text"}})],1),e("div",{staticClass:"skeleton-row"},[e("el-skeleton-item",{staticClass:"skeleton-rect",staticStyle:{width:"50px",height:"20px"},attrs:{variant:"rect"}})],1),e("div",{staticClass:"skeleton-row"},[e("el-skeleton-item",{staticClass:"skeleton-text",staticStyle:{width:"100%"},attrs:{variant:"text"}})],1),e("div",{staticClass:"skeleton-row"},[e("el-skeleton-item",{staticClass:"skeleton-text",staticStyle:{width:"100%"},attrs:{variant:"text"}})],1)])],2)],1)},r=[],c={name:"vote-skeleton-text"},d=c,u=(i("b4eb"),i("2877")),v=Object(u["a"])(d,l,r,!1,null,"3ca2c92b",null),h=v.exports,p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vote-skeleton"},[e("el-skeleton",{attrs:{animated:""}},[e("template",{slot:"template"},[e("div",{staticClass:"skeleton-container"},[e("div",{staticClass:"skeleton-card"},[e("el-skeleton",{attrs:{rows:4,loading:!0,animated:""}},[e("template",{slot:"template"},[e("el-skeleton-item",{staticClass:"skeleton-image",staticStyle:{width:"100%",height:"120px"},attrs:{variant:"image"}}),e("div",{staticClass:"skeleton-content"},[e("el-skeleton-item",{staticStyle:{width:"80%"},attrs:{variant:"p"}}),e("el-skeleton-item",{staticStyle:{width:"60%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"40%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"20%"},attrs:{variant:"text"}})],1)],1)],2)],1),e("div",{staticClass:"skeleton-card"},[e("el-skeleton",{attrs:{rows:4,loading:!0,animated:""}},[e("template",{slot:"template"},[e("el-skeleton-item",{staticClass:"skeleton-image",staticStyle:{width:"100%",height:"120px"},attrs:{variant:"image"}}),e("div",{staticClass:"skeleton-content"},[e("el-skeleton-item",{staticStyle:{width:"60%"},attrs:{variant:"p"}}),e("el-skeleton-item",{staticStyle:{width:"40%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"20%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"10%"},attrs:{variant:"text"}})],1)],1)],2)],1),e("div",{staticClass:"skeleton-card"},[e("el-skeleton",{attrs:{rows:4,loading:!0,animated:""}},[e("template",{slot:"template"},[e("el-skeleton-item",{staticClass:"skeleton-image",staticStyle:{width:"100%",height:"120px"},attrs:{variant:"image"}}),e("div",{staticClass:"skeleton-content"},[e("el-skeleton-item",{staticStyle:{width:"40%"},attrs:{variant:"p"}}),e("el-skeleton-item",{staticStyle:{width:"20%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"10%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"5%"},attrs:{variant:"text"}})],1)],1)],2)],1)])])],2)],1)},m=[],f={name:"vote-skeleton-image"},g=f,y=(i("fd01"),Object(u["a"])(g,p,m,!1,null,"948b0e1e",null)),k=y.exports,x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vote-people"},[t.loading?e("content-skeleton"):e("div",[e("div",{staticClass:"vote-people-select-container"},[e("el-select",{staticClass:"vote-people-select",attrs:{placeholder:"请选择"},model:{value:t.voteIndex,callback:function(e){t.voteIndex=e},expression:"voteIndex"}},t._l(t.votePeople,(function(t,i){var s;return e("el-option",{key:t.id,attrs:{label:`${t.text} (${(null!==(s=null===t||void 0===t?void 0:t.voted)&&void 0!==s?s:[]).length}人)`,value:i}})})),1)],1),t.votePeople[t.voteIndex]?e("div",[0===t.votePeople[t.voteIndex].voted.length?e("div",{staticClass:"vote-people-empty"},[t._v("暂时无人投票")]):e("div",{staticClass:"vote-people-list-container"},[e("div",{staticClass:"vote-people-list"},t._l(t.pagedVotePeople,(function(i){return e("div",{key:i.uid,staticClass:"vote-people-item"},[e("div",{staticClass:"vote-people-avatar"},[e("link-avatar",{attrs:{avatar:i.avatar,size:50,auth:i.auth,uid:i.uid,authentication:i.authentication,nickname:i.nickname}})],1),e("div",{staticClass:"vote-people-nickname"},[t._v(t._s(i.nickname))])])})),0),t.totalPages>=2?e("el-pagination",{staticClass:"vote-people-pagination",attrs:{"current-page":t.currentPage,"page-size":t.pageSize,"prev-text":"上一页","next-text":"下一页",layout:"prev, pager, next, jumper",total:t.votePeople[t.voteIndex].voted.length},on:{"current-change":t.handleCurrentChange}}):t._e()],1)]):t._e()])],1)},C=[],w=i("234f"),b=i("c362"),_=i("2f62"),I={name:"vote-people",props:{voteId:{type:Number,require:!0}},components:{ContentSkeleton:w["a"],LinkAvatar:b["a"]},data(){return{votePeople:[],loading:!1,voteIndex:0,currentPage:1}},watch:{voteIndex(){this.currentPage=1}},computed:{...Object(_["d"])({isMobile:t=>t.media.isMobile}),pageSize(){return null!==this&&void 0!==this&&this.isMobile?10:25},totalPages(){return Math.ceil(this.votePeople[this.voteIndex].voted.length/this.pageSize)},pagedVotePeople(){let t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.votePeople[this.voteIndex].voted.slice(t,e)}},methods:{handleCurrentChange(t){this.currentPage=t},fetchVotePeople:async function(){this.loading=!0;try{const{code:t,msg:e,list:i}=await o["a"].get(""+n["a"].people,{params:{id:this.voteId}});0!==t?this.$message({type:"warning",message:"获取投票人信息失败: "+e}):this.votePeople=i}catch(t){this.$message({type:"error",message:"发生错误，请重试",zIndex:1e4})}finally{this.loading=!1}}},async mounted(){await this.fetchVotePeople()}},S=I,V=(i("b2ad"),Object(u["a"])(S,x,C,!1,null,"56ae7e05",null)),O=V.exports,L=i("dbbe"),P=i("08a9"),$={name:"vote-panel",props:{voteId:{type:Number,required:!0},postId:{type:Number,required:!0},expandVotePanel:{type:Boolean,required:!1,default:!1},hideToggleButton:{type:Boolean,required:!1,default:!1}},components:{voteSkeletonText:h,voteSkeletonImage:k,VotePeople:O,HButton:L["a"],ElImageViewer:P["a"]},data(){return{modelVisible:!1,voteCollapse:!this.expandVotePanel,loading:!1,options:[],vote:{},total:0,selectedOptionIdList:[],showViewer:!1,primaryPictures:[],cardBorderVisible:!0}},computed:{...Object(_["d"])({isMobile:t=>t.media.isMobile}),currentUserHasVoted(){var t;return null===(t=this.options)||void 0===t?void 0:t.some(t=>null===t||void 0===t?void 0:t.voted)},voteHasExpired(){var t;return 1===(null===(t=this.vote)||void 0===t?void 0:t.status)},votePeopleButtonVisible(){var t;return 0===(null===(t=this.vote)||void 0===t?void 0:t.privacy)&&(this.voteHasExpired||this.currentUserHasVoted)},voteTimeStatus(){if(this.voteHasExpired)return"已结束";{const t=new Date(this.vote.endTime),e=new Date,i=t-e;if(i<0)return"已结束";const s=Math.floor(i/1e3),a=Math.floor(s/60),o=Math.floor(a/60),n=Math.floor(o/24);return n>0?`距结束还有${n}天${o%24}时`:o>0?`距结束还有${o}时${a%60}分`:a>0?`距结束还有${a}分${s%60}秒`:`距结束还有${s}秒`}},totalVoteCount:function(){return 0===this.vote.checkType?this.total:this.options.reduce((t,e)=>{var i;return null!==(i=t+(null===e||void 0===e?void 0:e.num))&&void 0!==i?i:0},0)}},mounted:function(){this.expandVotePanel&&this.handleVoteDataFetch()},methods:{handleCardMouseOver(){this.cardBorderVisible=!0},handleCardMouseLeave(){this.cardBorderVisible=!1},handleImageMouseOver(){this.cardBorderVisible=!1},handleImageMouseLeave(){this.cardBorderVisible=!0},calculateVotePercentage(t){return 0===this.totalVoteCount?"0%":t===this.totalVoteCount?"100%":(t/this.totalVoteCount*100).toFixed(2)+"%"},handlePreviewClose(){this.showViewer=!1},handlePreview(t){this.primaryPictures=[t],this.showViewer=!0},handleModelClose:function(){this.modelVisible=!1},handleVoteCollapse:function(){this.voteCollapse=!0},handleVoteExpand:async function(){this.voteCollapse=!1,await this.handleVoteDataFetch()},handleVoteDataFetch:async function(){this.loading=!0;try{const{code:t,vote:e,options:i,total:s,msg:a}=await o["a"].get(`${n["a"].info}${this.voteId}`);0!==t?this.$message({type:"warning",message:"获取投票信息失败: "+a}):(this.vote=null!==e&&void 0!==e?e:{},this.options=null!==i&&void 0!==i?i:[],this.total=s,this.selectedOptionIdList=i.filter(t=>null===t||void 0===t?void 0:t.voted).map(t=>t.id))}catch(t){this.$message({type:"error",message:"发生错误，请重试"})}finally{this.loading=!1}},handleSeeVotePeople:function(){this.modelVisible=!0},handleOptionClick:async function(t){0===this.vote.checkType?this.selectedOptionIdList.includes(t.id)?this.selectedOptionIdList=[]:this.selectedOptionIdList=[t.id]:this.selectedOptionIdList.includes(t.id)?this.selectedOptionIdList=this.selectedOptionIdList.filter(e=>e!==t.id):this.selectedOptionIdList.length<this.vote.max?this.selectedOptionIdList.push(t.id):this.$message({type:"warning",message:`最多只能选择${this.vote.max}项`})},handleVoteConfirm:async function(){try{const{code:t,msg:e}=await o["a"].post(n["a"].vote,{postId:this.postId,voteId:this.voteId,vote:this.selectedOptionIdList});0!==t?this.$message({type:"warning",message:"投票失败: "+e}):(this.$message({type:"success",message:"投票成功"}),this.handleVoteDataFetch())}catch(t){this.$message({type:"error",message:"发生错误，请重试"})}}}},z=$,H=(i("7ce7"),Object(u["a"])(z,s,a,!1,null,"afab0c30",null));e["a"]=H.exports},d58f:function(t,e,i){var s=i("59ed"),a=i("7b0b"),o=i("44ad"),n=i("07fa"),l=TypeError,r=function(t){return function(e,i,r,c){s(i);var d=a(e),u=o(d),v=n(d),h=t?v-1:0,p=t?-1:1;if(r<2)while(1){if(h in u){c=u[h],h+=p;break}if(h+=p,t?h<0:v<=h)throw l("Reduce of empty array with no initial value")}for(;t?h>=0:v>h;h+=p)h in u&&(c=i(c,u[h],h,d));return c}};t.exports={left:r(!1),right:r(!0)}},f39e:function(t,e,i){},fd01:function(t,e,i){"use strict";i("b717")}}]);